<!doctype html>
<html lang="en" itemscope itemtype="http://schema.org/WebPage">
<head>
  <meta charset="utf-8">
  <meta name="x-ua-compatible" content="ie=edge">
  <title itemprop="name">backbone.marionette.js</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="apple-touch-icon" sizes="57x57" href="/apple-touch-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/apple-touch-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/apple-touch-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/apple-touch-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/apple-touch-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/apple-touch-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/apple-touch-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/apple-touch-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon-180x180.png">
  <link rel="icon" type="image/png" href="/favicon-32x32.png" sizes="32x32">
  <link rel="icon" type="image/png" href="/android-chrome-192x192.png" sizes="192x192">
  <link rel="icon" type="image/png" href="/favicon-96x96.png" sizes="96x96">
  <link rel="icon" type="image/png" href="/favicon-16x16.png" sizes="16x16">
  <link rel="manifest" href="/manifest.json">
  <meta name="msapplication-TileColor" content="#b91d47">
  <meta name="msapplication-TileImage" content="/mstile-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <link rel="stylesheet" media="all" href="../../styles/docco.860affb898b6e45b.860affb898b6e45b.860affb898b6e45b.860affb898b6e45b.860affb898b6e45b.860affb898b6e45b.860affb898b6e45b.860affb898b6e45b.860affb898b6e45b.css" />
</head>
<body>
  <div id="container">
    <div id="background"></div>
    
    <ul class="sections">
        
          <li id="title">
              <div class="annotation">
                  <h1>backbone.marionette.js</h1>
              </div>
          </li>
        
        
        
        <li id="section-1">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-1">&#182;</a>
              </div>
              <h2 id="marionettejs-backbone-marionette-">MarionetteJS (Backbone.Marionette)</h2>

            </div>
            
        </li>
        
        
        <li id="section-2">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-2">&#182;</a>
              </div>
              <p>v2.0.3</p>
<p>Copyright (c)2014 Derick Bailey, Muted Solutions, LLC.
Distributed under MIT license</p>
<p><a href="http://marionettejs.com">http://marionettejs.com</a></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>

<span class="hljs-comment">/*!
 * Includes BabySitter
 * https://github.com/marionettejs/backbone.babysitter/
 *
 * Includes Wreqr
 * https://github.com/marionettejs/backbone.wreqr/
 */</span>


(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">root, factory</span>) </span>{

  <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> define === <span class="hljs-string">'function'</span> &amp;&amp; define.amd) {
    define([<span class="hljs-string">'backbone'</span>, <span class="hljs-string">'underscore'</span>], <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">Backbone, _</span>) </span>{
      <span class="hljs-keyword">return</span> (root.Marionette = factory(root, Backbone, _));
    });
  } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> exports !== <span class="hljs-string">'undefined'</span>) {
    <span class="hljs-keyword">var</span> Backbone = <span class="hljs-built_in">require</span>(<span class="hljs-string">'backbone'</span>);
    <span class="hljs-keyword">var</span> _ = <span class="hljs-built_in">require</span>(<span class="hljs-string">'underscore'</span>);
    <span class="hljs-built_in">module</span>.exports = factory(root, Backbone, _);
  } <span class="hljs-keyword">else</span> {
    root.Marionette = factory(root, root.Backbone, root._);
  }

}(<span class="hljs-keyword">this</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">root, Backbone, _</span>) </span>{
<span class="hljs-meta">  'use strict'</span>;</pre></div></div>
            
        </li>
        
        
        <li id="section-3">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-3">&#182;</a>
              </div>
              <h2 id="backbone-babysitter">Backbone.BabySitter</h2>

            </div>
            
        </li>
        
        
        <li id="section-4">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-4">&#182;</a>
              </div>
              <p>v0.1.4</p>
<p>Copyright (c)2014 Derick Bailey, Muted Solutions, LLC.
Distributed under MIT license</p>
<p><a href="http://github.com/marionettejs/backbone.babysitter">http://github.com/marionettejs/backbone.babysitter</a></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  (<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">Backbone, _</span>) </span>{
<span class="hljs-meta">    "use strict"</span>;
    <span class="hljs-keyword">var</span> previousChildViewContainer = Backbone.ChildViewContainer;</pre></div></div>
            
        </li>
        
        
        <li id="section-5">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-5">&#182;</a>
              </div>
              <h2 id="babysitter-childviewcontainer">BabySitter.ChildViewContainer</h2>

            </div>
            
        </li>
        
        
        <li id="section-6">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-6">&#182;</a>
              </div>
              <p>Provide a container to store, retrieve and
shut down child views.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    Backbone.ChildViewContainer = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">Backbone, _</span>) </span>{</pre></div></div>
            
        </li>
        
        
        <li id="section-7">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-7">&#182;</a>
              </div>
              <h2 id="container-constructor">Container Constructor</h2>

            </div>
            
        </li>
        
        
        <li id="section-8">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-8">&#182;</a>
              </div>
              
            </div>
            
            <div class="content"><div class='highlight'><pre>      <span class="hljs-keyword">var</span> Container = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">views</span>) </span>{
        <span class="hljs-keyword">this</span>._views = {};
        <span class="hljs-keyword">this</span>._indexByModel = {};
        <span class="hljs-keyword">this</span>._indexByCustom = {};
        <span class="hljs-keyword">this</span>._updateLength();
        _.each(views, <span class="hljs-keyword">this</span>.add, <span class="hljs-keyword">this</span>);
      };</pre></div></div>
            
        </li>
        
        
        <li id="section-9">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-9">&#182;</a>
              </div>
              <h2 id="container-methods">Container Methods</h2>

            </div>
            
        </li>
        
        
        <li id="section-10">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-10">&#182;</a>
              </div>
              
            </div>
            
            <div class="content"><div class='highlight'><pre>      _.extend(Container.prototype, {</pre></div></div>
            
        </li>
        
        
        <li id="section-11">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-11">&#182;</a>
              </div>
              <p>Add a view to this container. Stores the view
by <code>cid</code> and makes it searchable by the model
cid (and model itself). Optionally specify
a custom key to store an retrieve the view.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        add: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">view, customIndex</span>) </span>{
          <span class="hljs-keyword">var</span> viewCid = view.cid;</pre></div></div>
            
        </li>
        
        
        <li id="section-12">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-12">&#182;</a>
              </div>
              <p>store the view</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>          <span class="hljs-keyword">this</span>._views[viewCid] = view;</pre></div></div>
            
        </li>
        
        
        <li id="section-13">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-13">&#182;</a>
              </div>
              <p>index it by model</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>          <span class="hljs-keyword">if</span> (view.model) {
            <span class="hljs-keyword">this</span>._indexByModel[view.model.cid] = viewCid;
          }</pre></div></div>
            
        </li>
        
        
        <li id="section-14">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-14">&#182;</a>
              </div>
              <p>index by custom</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>          <span class="hljs-keyword">if</span> (customIndex) {
            <span class="hljs-keyword">this</span>._indexByCustom[customIndex] = viewCid;
          }
          <span class="hljs-keyword">this</span>._updateLength();
          <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;
        },</pre></div></div>
            
        </li>
        
        
        <li id="section-15">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-15">&#182;</a>
              </div>
              <p>Find a view by the model that was attached to
it. Uses the model’s <code>cid</code> to find it.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        findByModel: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">model</span>) </span>{
          <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.findByModelCid(model.cid);
        },</pre></div></div>
            
        </li>
        
        
        <li id="section-16">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-16">&#182;</a>
              </div>
              <p>Find a view by the <code>cid</code> of the model that was attached to
it. Uses the model’s <code>cid</code> to find the view <code>cid</code> and
retrieve the view using it.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        findByModelCid: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">modelCid</span>) </span>{
          <span class="hljs-keyword">var</span> viewCid = <span class="hljs-keyword">this</span>._indexByModel[modelCid];
          <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.findByCid(viewCid);
        },</pre></div></div>
            
        </li>
        
        
        <li id="section-17">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-17">&#182;</a>
              </div>
              <p>Find a view by a custom indexer.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        findByCustom: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">index</span>) </span>{
          <span class="hljs-keyword">var</span> viewCid = <span class="hljs-keyword">this</span>._indexByCustom[index];
          <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.findByCid(viewCid);
        },</pre></div></div>
            
        </li>
        
        
        <li id="section-18">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-18">&#182;</a>
              </div>
              <p>Find by index. This is not guaranteed to be a
stable index.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        findByIndex: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">index</span>) </span>{
          <span class="hljs-keyword">return</span> _.values(<span class="hljs-keyword">this</span>._views)[index];
        },</pre></div></div>
            
        </li>
        
        
        <li id="section-19">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-19">&#182;</a>
              </div>
              <p>retrieve a view by its <code>cid</code> directly</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        findByCid: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">cid</span>) </span>{
          <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>._views[cid];
        },</pre></div></div>
            
        </li>
        
        
        <li id="section-20">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-20">&#182;</a>
              </div>
              <p>Remove a view</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        remove: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">view</span>) </span>{
          <span class="hljs-keyword">var</span> viewCid = view.cid;</pre></div></div>
            
        </li>
        
        
        <li id="section-21">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-21">&#182;</a>
              </div>
              <p>delete model index</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>          <span class="hljs-keyword">if</span> (view.model) {
            <span class="hljs-keyword">delete</span> <span class="hljs-keyword">this</span>._indexByModel[view.model.cid];
          }</pre></div></div>
            
        </li>
        
        
        <li id="section-22">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-22">&#182;</a>
              </div>
              <p>delete custom index</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>          _.any(<span class="hljs-keyword">this</span>._indexByCustom, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">cid, key</span>) </span>{
            <span class="hljs-keyword">if</span> (cid === viewCid) {
              <span class="hljs-keyword">delete</span> <span class="hljs-keyword">this</span>._indexByCustom[key];
              <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
            }
          }, <span class="hljs-keyword">this</span>);</pre></div></div>
            
        </li>
        
        
        <li id="section-23">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-23">&#182;</a>
              </div>
              <p>remove the view from the container</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>          <span class="hljs-keyword">delete</span> <span class="hljs-keyword">this</span>._views[viewCid];</pre></div></div>
            
        </li>
        
        
        <li id="section-24">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-24">&#182;</a>
              </div>
              <p>update the length</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>          <span class="hljs-keyword">this</span>._updateLength();
          <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;
        },</pre></div></div>
            
        </li>
        
        
        <li id="section-25">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-25">&#182;</a>
              </div>
              <p>Call a method on every view in the container,
passing parameters to the call method one at a
time, like <code>function.call</code>.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        call: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">method</span>) </span>{
          <span class="hljs-keyword">this</span>.apply(method, _.tail(<span class="hljs-built_in">arguments</span>));
        },</pre></div></div>
            
        </li>
        
        
        <li id="section-26">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-26">&#182;</a>
              </div>
              <p>Apply a method on every view in the container,
passing parameters to the call method one at a
time, like <code>function.apply</code>.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        apply: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">method, args</span>) </span>{
          _.each(<span class="hljs-keyword">this</span>._views, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">view</span>) </span>{
            <span class="hljs-keyword">if</span> (_.isFunction(view[method])) {
              view[method].apply(view, args || []);
            }
          });
        },</pre></div></div>
            
        </li>
        
        
        <li id="section-27">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-27">&#182;</a>
              </div>
              <p>Update the <code>.length</code> attribute on this container</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        _updateLength: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
          <span class="hljs-keyword">this</span>.length = _.size(<span class="hljs-keyword">this</span>._views);
        }
      });</pre></div></div>
            
        </li>
        
        
        <li id="section-28">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-28">&#182;</a>
              </div>
              <p>Borrowing this code from Backbone.Collection:
<a href="http://backbonejs.org/docs/backbone.html#section-106">http://backbonejs.org/docs/backbone.html#section-106</a></p>
<p>Mix in methods from Underscore, for iteration, and other
collection related features.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      <span class="hljs-keyword">var</span> methods = [ <span class="hljs-string">"forEach"</span>, <span class="hljs-string">"each"</span>, <span class="hljs-string">"map"</span>, <span class="hljs-string">"find"</span>, <span class="hljs-string">"detect"</span>, <span class="hljs-string">"filter"</span>, <span class="hljs-string">"select"</span>, <span class="hljs-string">"reject"</span>, <span class="hljs-string">"every"</span>, <span class="hljs-string">"all"</span>, <span class="hljs-string">"some"</span>, <span class="hljs-string">"any"</span>, <span class="hljs-string">"include"</span>, <span class="hljs-string">"contains"</span>, <span class="hljs-string">"invoke"</span>, <span class="hljs-string">"toArray"</span>, <span class="hljs-string">"first"</span>, <span class="hljs-string">"initial"</span>, <span class="hljs-string">"rest"</span>, <span class="hljs-string">"last"</span>, <span class="hljs-string">"without"</span>, <span class="hljs-string">"isEmpty"</span>, <span class="hljs-string">"pluck"</span> ];
      _.each(methods, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">method</span>) </span>{
        Container.prototype[method] = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
          <span class="hljs-keyword">var</span> views = _.values(<span class="hljs-keyword">this</span>._views);
          <span class="hljs-keyword">var</span> args = [ views ].concat(_.toArray(<span class="hljs-built_in">arguments</span>));
          <span class="hljs-keyword">return</span> _[method].apply(_, args);
        };
      });</pre></div></div>
            
        </li>
        
        
        <li id="section-29">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-29">&#182;</a>
              </div>
              <p>return the public API</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      <span class="hljs-keyword">return</span> Container;
    }(Backbone, _);
    Backbone.ChildViewContainer.VERSION = <span class="hljs-string">"0.1.4"</span>;
    Backbone.ChildViewContainer.noConflict = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
      Backbone.ChildViewContainer = previousChildViewContainer;
      <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;
    };
    <span class="hljs-keyword">return</span> Backbone.ChildViewContainer;
  })(Backbone, _);</pre></div></div>
            
        </li>
        
        
        <li id="section-30">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-30">&#182;</a>
              </div>
              <h2 id="backbone-wreqr-backbone-marionette-">Backbone.Wreqr (Backbone.Marionette)</h2>

            </div>
            
        </li>
        
        
        <li id="section-31">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-31">&#182;</a>
              </div>
              <p>v1.3.1</p>
<p>Copyright (c)2014 Derick Bailey, Muted Solutions, LLC.
Distributed under MIT license</p>
<p><a href="http://github.com/marionettejs/backbone.wreqr">http://github.com/marionettejs/backbone.wreqr</a></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  (<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">Backbone, _</span>) </span>{
<span class="hljs-meta">    "use strict"</span>;
    <span class="hljs-keyword">var</span> previousWreqr = Backbone.Wreqr;
    <span class="hljs-keyword">var</span> Wreqr = Backbone.Wreqr = {};
    Backbone.Wreqr.VERSION = <span class="hljs-string">"1.3.1"</span>;
    Backbone.Wreqr.noConflict = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
      Backbone.Wreqr = previousWreqr;
      <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;
    };</pre></div></div>
            
        </li>
        
        
        <li id="section-32">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-32">&#182;</a>
              </div>
              <h2 id="handlers">Handlers</h2>

            </div>
            
        </li>
        
        
        <li id="section-33">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-33">&#182;</a>
              </div>
              <p>A registry of functions to call, given a name</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    Wreqr.Handlers = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">Backbone, _</span>) </span>{
<span class="hljs-meta">      "use strict"</span>;</pre></div></div>
            
        </li>
        
        
        <li id="section-34">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-34">&#182;</a>
              </div>
              <h2 id="constructor">Constructor</h2>

            </div>
            
        </li>
        
        
        <li id="section-35">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-35">&#182;</a>
              </div>
              
            </div>
            
            <div class="content"><div class='highlight'><pre>      <span class="hljs-keyword">var</span> Handlers = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">options</span>) </span>{
        <span class="hljs-keyword">this</span>.options = options;
        <span class="hljs-keyword">this</span>._wreqrHandlers = {};
        <span class="hljs-keyword">if</span> (_.isFunction(<span class="hljs-keyword">this</span>.initialize)) {
          <span class="hljs-keyword">this</span>.initialize(options);
        }
      };
      Handlers.extend = Backbone.Model.extend;</pre></div></div>
            
        </li>
        
        
        <li id="section-36">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-36">&#182;</a>
              </div>
              <h2 id="instance-members">Instance Members</h2>

            </div>
            
        </li>
        
        
        <li id="section-37">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-37">&#182;</a>
              </div>
              
            </div>
            
            <div class="content"><div class='highlight'><pre>      _.extend(Handlers.prototype, Backbone.Events, {</pre></div></div>
            
        </li>
        
        
        <li id="section-38">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-38">&#182;</a>
              </div>
              <p>Add multiple handlers using an object literal configuration</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        setHandlers: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">handlers</span>) </span>{
          _.each(handlers, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">handler, name</span>) </span>{
            <span class="hljs-keyword">var</span> context = <span class="hljs-literal">null</span>;
            <span class="hljs-keyword">if</span> (_.isObject(handler) &amp;&amp; !_.isFunction(handler)) {
              context = handler.context;
              handler = handler.callback;
            }
            <span class="hljs-keyword">this</span>.setHandler(name, handler, context);
          }, <span class="hljs-keyword">this</span>);
        },</pre></div></div>
            
        </li>
        
        
        <li id="section-39">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-39">&#182;</a>
              </div>
              <p>Add a handler for the given name, with an
optional context to run the handler within</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        setHandler: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">name, handler, context</span>) </span>{
          <span class="hljs-keyword">var</span> config = {
            <span class="hljs-attr">callback</span>: handler,
            <span class="hljs-attr">context</span>: context
          };
          <span class="hljs-keyword">this</span>._wreqrHandlers[name] = config;
          <span class="hljs-keyword">this</span>.trigger(<span class="hljs-string">"handler:add"</span>, name, handler, context);
        },</pre></div></div>
            
        </li>
        
        
        <li id="section-40">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-40">&#182;</a>
              </div>
              <p>Determine whether or not a handler is registered</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        hasHandler: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">name</span>) </span>{
          <span class="hljs-keyword">return</span> !!<span class="hljs-keyword">this</span>._wreqrHandlers[name];
        },</pre></div></div>
            
        </li>
        
        
        <li id="section-41">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-41">&#182;</a>
              </div>
              <p>Get the currently registered handler for
the specified name. Throws an exception if
no handler is found.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        getHandler: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">name</span>) </span>{
          <span class="hljs-keyword">var</span> config = <span class="hljs-keyword">this</span>._wreqrHandlers[name];
          <span class="hljs-keyword">if</span> (!config) {
            <span class="hljs-keyword">return</span>;
          }
          <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
            <span class="hljs-keyword">var</span> args = <span class="hljs-built_in">Array</span>.prototype.slice.apply(<span class="hljs-built_in">arguments</span>);
            <span class="hljs-keyword">return</span> config.callback.apply(config.context, args);
          };
        },</pre></div></div>
            
        </li>
        
        
        <li id="section-42">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-42">&#182;</a>
              </div>
              <p>Remove a handler for the specified name</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        removeHandler: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">name</span>) </span>{
          <span class="hljs-keyword">delete</span> <span class="hljs-keyword">this</span>._wreqrHandlers[name];
        },</pre></div></div>
            
        </li>
        
        
        <li id="section-43">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-43">&#182;</a>
              </div>
              <p>Remove all handlers from this registry</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        removeAllHandlers: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
          <span class="hljs-keyword">this</span>._wreqrHandlers = {};
        }
      });
      <span class="hljs-keyword">return</span> Handlers;
    }(Backbone, _);</pre></div></div>
            
        </li>
        
        
        <li id="section-44">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-44">&#182;</a>
              </div>
              <h2 id="wreqr-commandstorage">Wreqr.CommandStorage</h2>

            </div>
            
        </li>
        
        
        <li id="section-45">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-45">&#182;</a>
              </div>
              <p>Store and retrieve commands for execution.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    Wreqr.CommandStorage = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
<span class="hljs-meta">      "use strict"</span>;</pre></div></div>
            
        </li>
        
        
        <li id="section-46">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-46">&#182;</a>
              </div>
              <p>Constructor function</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      <span class="hljs-keyword">var</span> CommandStorage = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">options</span>) </span>{
        <span class="hljs-keyword">this</span>.options = options;
        <span class="hljs-keyword">this</span>._commands = {};
        <span class="hljs-keyword">if</span> (_.isFunction(<span class="hljs-keyword">this</span>.initialize)) {
          <span class="hljs-keyword">this</span>.initialize(options);
        }
      };</pre></div></div>
            
        </li>
        
        
        <li id="section-47">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-47">&#182;</a>
              </div>
              <p>Instance methods</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      _.extend(CommandStorage.prototype, Backbone.Events, {</pre></div></div>
            
        </li>
        
        
        <li id="section-48">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-48">&#182;</a>
              </div>
              <p>Get an object literal by command name, that contains
the <code>commandName</code> and the <code>instances</code> of all commands
represented as an array of arguments to process</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        getCommands: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">commandName</span>) </span>{
          <span class="hljs-keyword">var</span> commands = <span class="hljs-keyword">this</span>._commands[commandName];</pre></div></div>
            
        </li>
        
        
        <li id="section-49">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-49">&#182;</a>
              </div>
              <p>we don’t have it, so add it</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>          <span class="hljs-keyword">if</span> (!commands) {</pre></div></div>
            
        </li>
        
        
        <li id="section-50">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-50">&#182;</a>
              </div>
              <p>build the configuration</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>            commands = {
              <span class="hljs-attr">command</span>: commandName,
              <span class="hljs-attr">instances</span>: []
            };</pre></div></div>
            
        </li>
        
        
        <li id="section-51">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-51">&#182;</a>
              </div>
              <p>store it</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>            <span class="hljs-keyword">this</span>._commands[commandName] = commands;
          }
          <span class="hljs-keyword">return</span> commands;
        },</pre></div></div>
            
        </li>
        
        
        <li id="section-52">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-52">&#182;</a>
              </div>
              <p>Add a command by name, to the storage and store the
args for the command</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        addCommand: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">commandName, args</span>) </span>{
          <span class="hljs-keyword">var</span> command = <span class="hljs-keyword">this</span>.getCommands(commandName);
          command.instances.push(args);
        },</pre></div></div>
            
        </li>
        
        
        <li id="section-53">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-53">&#182;</a>
              </div>
              <p>Clear all commands for the given <code>commandName</code></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        clearCommands: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">commandName</span>) </span>{
          <span class="hljs-keyword">var</span> command = <span class="hljs-keyword">this</span>.getCommands(commandName);
          command.instances = [];
        }
      });
      <span class="hljs-keyword">return</span> CommandStorage;
    }();</pre></div></div>
            
        </li>
        
        
        <li id="section-54">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-54">&#182;</a>
              </div>
              <h2 id="wreqr-commands">Wreqr.Commands</h2>

            </div>
            
        </li>
        
        
        <li id="section-55">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-55">&#182;</a>
              </div>
              <p>A simple command pattern implementation. Register a command
handler and execute it.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    Wreqr.Commands = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">Wreqr</span>) </span>{
<span class="hljs-meta">      "use strict"</span>;
      <span class="hljs-keyword">return</span> Wreqr.Handlers.extend({</pre></div></div>
            
        </li>
        
        
        <li id="section-56">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-56">&#182;</a>
              </div>
              <p>default storage type</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        storageType: Wreqr.CommandStorage,
        <span class="hljs-attr">constructor</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">options</span>) </span>{
          <span class="hljs-keyword">this</span>.options = options || {};
          <span class="hljs-keyword">this</span>._initializeStorage(<span class="hljs-keyword">this</span>.options);
          <span class="hljs-keyword">this</span>.on(<span class="hljs-string">"handler:add"</span>, <span class="hljs-keyword">this</span>._executeCommands, <span class="hljs-keyword">this</span>);
          <span class="hljs-keyword">var</span> args = <span class="hljs-built_in">Array</span>.prototype.slice.call(<span class="hljs-built_in">arguments</span>);
          Wreqr.Handlers.prototype.constructor.apply(<span class="hljs-keyword">this</span>, args);
        },</pre></div></div>
            
        </li>
        
        
        <li id="section-57">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-57">&#182;</a>
              </div>
              <p>Execute a named command with the supplied args</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        execute: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">name, args</span>) </span>{
          name = <span class="hljs-built_in">arguments</span>[<span class="hljs-number">0</span>];
          args = <span class="hljs-built_in">Array</span>.prototype.slice.call(<span class="hljs-built_in">arguments</span>, <span class="hljs-number">1</span>);
          <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.hasHandler(name)) {
            <span class="hljs-keyword">this</span>.getHandler(name).apply(<span class="hljs-keyword">this</span>, args);
          } <span class="hljs-keyword">else</span> {
            <span class="hljs-keyword">this</span>.storage.addCommand(name, args);
          }
        },</pre></div></div>
            
        </li>
        
        
        <li id="section-58">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-58">&#182;</a>
              </div>
              <p>Internal method to handle bulk execution of stored commands</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        _executeCommands: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">name, handler, context</span>) </span>{
          <span class="hljs-keyword">var</span> command = <span class="hljs-keyword">this</span>.storage.getCommands(name);</pre></div></div>
            
        </li>
        
        
        <li id="section-59">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-59">&#182;</a>
              </div>
              <p>loop through and execute all the stored command instances</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>          _.each(command.instances, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">args</span>) </span>{
            handler.apply(context, args);
          });
          <span class="hljs-keyword">this</span>.storage.clearCommands(name);
        },</pre></div></div>
            
        </li>
        
        
        <li id="section-60">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-60">&#182;</a>
              </div>
              <p>Internal method to initialize storage either from the type’s
<code>storageType</code> or the instance <code>options.storageType</code>.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        _initializeStorage: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">options</span>) </span>{
          <span class="hljs-keyword">var</span> storage;
          <span class="hljs-keyword">var</span> StorageType = options.storageType || <span class="hljs-keyword">this</span>.storageType;
          <span class="hljs-keyword">if</span> (_.isFunction(StorageType)) {
            storage = <span class="hljs-keyword">new</span> StorageType();
          } <span class="hljs-keyword">else</span> {
            storage = StorageType;
          }
          <span class="hljs-keyword">this</span>.storage = storage;
        }
      });
    }(Wreqr);</pre></div></div>
            
        </li>
        
        
        <li id="section-61">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-61">&#182;</a>
              </div>
              <h2 id="wreqr-requestresponse">Wreqr.RequestResponse</h2>

            </div>
            
        </li>
        
        
        <li id="section-62">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-62">&#182;</a>
              </div>
              <p>A simple request/response implementation. Register a
request handler, and return a response from it</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    Wreqr.RequestResponse = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">Wreqr</span>) </span>{
<span class="hljs-meta">      "use strict"</span>;
      <span class="hljs-keyword">return</span> Wreqr.Handlers.extend({
        <span class="hljs-attr">request</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
          <span class="hljs-keyword">var</span> name = <span class="hljs-built_in">arguments</span>[<span class="hljs-number">0</span>];
          <span class="hljs-keyword">var</span> args = <span class="hljs-built_in">Array</span>.prototype.slice.call(<span class="hljs-built_in">arguments</span>, <span class="hljs-number">1</span>);
          <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.hasHandler(name)) {
            <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.getHandler(name).apply(<span class="hljs-keyword">this</span>, args);
          }
        }
      });
    }(Wreqr);</pre></div></div>
            
        </li>
        
        
        <li id="section-63">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-63">&#182;</a>
              </div>
              <h2 id="event-aggregator">Event Aggregator</h2>

            </div>
            
        </li>
        
        
        <li id="section-64">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-64">&#182;</a>
              </div>
              <p>A pub-sub object that can be used to decouple various parts
of an application through event-driven architecture.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    Wreqr.EventAggregator = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">Backbone, _</span>) </span>{
<span class="hljs-meta">      "use strict"</span>;
      <span class="hljs-keyword">var</span> EA = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{};</pre></div></div>
            
        </li>
        
        
        <li id="section-65">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-65">&#182;</a>
              </div>
              <p>Copy the <code>extend</code> function used by Backbone’s classes</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      EA.extend = Backbone.Model.extend;</pre></div></div>
            
        </li>
        
        
        <li id="section-66">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-66">&#182;</a>
              </div>
              <p>Copy the basic Backbone.Events on to the event aggregator</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      _.extend(EA.prototype, Backbone.Events);
      <span class="hljs-keyword">return</span> EA;
    }(Backbone, _);</pre></div></div>
            
        </li>
        
        
        <li id="section-67">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-67">&#182;</a>
              </div>
              <h2 id="wreqr-channel">Wreqr.Channel</h2>

            </div>
            
        </li>
        
        
        <li id="section-68">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-68">&#182;</a>
              </div>
              <p>An object that wraps the three messaging systems:
EventAggregator, RequestResponse, Commands</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    Wreqr.Channel = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">Wreqr</span>) </span>{
<span class="hljs-meta">      "use strict"</span>;
      <span class="hljs-keyword">var</span> Channel = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">channelName</span>) </span>{
        <span class="hljs-keyword">this</span>.vent = <span class="hljs-keyword">new</span> Backbone.Wreqr.EventAggregator();
        <span class="hljs-keyword">this</span>.reqres = <span class="hljs-keyword">new</span> Backbone.Wreqr.RequestResponse();
        <span class="hljs-keyword">this</span>.commands = <span class="hljs-keyword">new</span> Backbone.Wreqr.Commands();
        <span class="hljs-keyword">this</span>.channelName = channelName;
      };
      _.extend(Channel.prototype, {</pre></div></div>
            
        </li>
        
        
        <li id="section-69">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-69">&#182;</a>
              </div>
              <p>Remove all handlers from the messaging systems of this channel</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        reset: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
          <span class="hljs-keyword">this</span>.vent.off();
          <span class="hljs-keyword">this</span>.vent.stopListening();
          <span class="hljs-keyword">this</span>.reqres.removeAllHandlers();
          <span class="hljs-keyword">this</span>.commands.removeAllHandlers();
          <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;
        },</pre></div></div>
            
        </li>
        
        
        <li id="section-70">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-70">&#182;</a>
              </div>
              <p>Connect a hash of events; one for each messaging system</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        connectEvents: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">hash, context</span>) </span>{
          <span class="hljs-keyword">this</span>._connect(<span class="hljs-string">"vent"</span>, hash, context);
          <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;
        },
        <span class="hljs-attr">connectCommands</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">hash, context</span>) </span>{
          <span class="hljs-keyword">this</span>._connect(<span class="hljs-string">"commands"</span>, hash, context);
          <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;
        },
        <span class="hljs-attr">connectRequests</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">hash, context</span>) </span>{
          <span class="hljs-keyword">this</span>._connect(<span class="hljs-string">"reqres"</span>, hash, context);
          <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;
        },</pre></div></div>
            
        </li>
        
        
        <li id="section-71">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-71">&#182;</a>
              </div>
              <p>Attach the handlers to a given message system <code>type</code></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        _connect: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">type, hash, context</span>) </span>{
          <span class="hljs-keyword">if</span> (!hash) {
            <span class="hljs-keyword">return</span>;
          }
          context = context || <span class="hljs-keyword">this</span>;
          <span class="hljs-keyword">var</span> method = type === <span class="hljs-string">"vent"</span> ? <span class="hljs-string">"on"</span> : <span class="hljs-string">"setHandler"</span>;
          _.each(hash, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">fn, eventName</span>) </span>{
            <span class="hljs-keyword">this</span>[type][method](eventName, _.bind(fn, context));
          }, <span class="hljs-keyword">this</span>);
        }
      });
      <span class="hljs-keyword">return</span> Channel;
    }(Wreqr);</pre></div></div>
            
        </li>
        
        
        <li id="section-72">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-72">&#182;</a>
              </div>
              <h2 id="wreqr-radio">Wreqr.Radio</h2>

            </div>
            
        </li>
        
        
        <li id="section-73">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-73">&#182;</a>
              </div>
              <p>An object that lets you communicate with many channels.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    Wreqr.radio = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">Wreqr</span>) </span>{
<span class="hljs-meta">      "use strict"</span>;
      <span class="hljs-keyword">var</span> Radio = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">this</span>._channels = {};
        <span class="hljs-keyword">this</span>.vent = {};
        <span class="hljs-keyword">this</span>.commands = {};
        <span class="hljs-keyword">this</span>.reqres = {};
        <span class="hljs-keyword">this</span>._proxyMethods();
      };
      _.extend(Radio.prototype, {
        <span class="hljs-attr">channel</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">channelName</span>) </span>{
          <span class="hljs-keyword">if</span> (!channelName) {
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">"Channel must receive a name"</span>);
          }
          <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>._getChannel(channelName);
        },
        <span class="hljs-attr">_getChannel</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">channelName</span>) </span>{
          <span class="hljs-keyword">var</span> channel = <span class="hljs-keyword">this</span>._channels[channelName];
          <span class="hljs-keyword">if</span> (!channel) {
            channel = <span class="hljs-keyword">new</span> Wreqr.Channel(channelName);
            <span class="hljs-keyword">this</span>._channels[channelName] = channel;
          }
          <span class="hljs-keyword">return</span> channel;
        },
        <span class="hljs-attr">_proxyMethods</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
          _.each([ <span class="hljs-string">"vent"</span>, <span class="hljs-string">"commands"</span>, <span class="hljs-string">"reqres"</span> ], <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">system</span>) </span>{
            _.each(messageSystems[system], <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">method</span>) </span>{
              <span class="hljs-keyword">this</span>[system][method] = proxyMethod(<span class="hljs-keyword">this</span>, system, method);
            }, <span class="hljs-keyword">this</span>);
          }, <span class="hljs-keyword">this</span>);
        }
      });
      <span class="hljs-keyword">var</span> messageSystems = {
        <span class="hljs-attr">vent</span>: [ <span class="hljs-string">"on"</span>, <span class="hljs-string">"off"</span>, <span class="hljs-string">"trigger"</span>, <span class="hljs-string">"once"</span>, <span class="hljs-string">"stopListening"</span>, <span class="hljs-string">"listenTo"</span>, <span class="hljs-string">"listenToOnce"</span> ],
        <span class="hljs-attr">commands</span>: [ <span class="hljs-string">"execute"</span>, <span class="hljs-string">"setHandler"</span>, <span class="hljs-string">"setHandlers"</span>, <span class="hljs-string">"removeHandler"</span>, <span class="hljs-string">"removeAllHandlers"</span> ],
        <span class="hljs-attr">reqres</span>: [ <span class="hljs-string">"request"</span>, <span class="hljs-string">"setHandler"</span>, <span class="hljs-string">"setHandlers"</span>, <span class="hljs-string">"removeHandler"</span>, <span class="hljs-string">"removeAllHandlers"</span> ]
      };
      <span class="hljs-keyword">var</span> proxyMethod = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">radio, system, method</span>) </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">channelName</span>) </span>{
          <span class="hljs-keyword">var</span> messageSystem = radio._getChannel(channelName)[system];
          <span class="hljs-keyword">var</span> args = <span class="hljs-built_in">Array</span>.prototype.slice.call(<span class="hljs-built_in">arguments</span>, <span class="hljs-number">1</span>);
          <span class="hljs-keyword">return</span> messageSystem[method].apply(messageSystem, args);
        };
      };
      <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> Radio();
    }(Wreqr);
    <span class="hljs-keyword">return</span> Backbone.Wreqr;
  })(Backbone, _);

  <span class="hljs-keyword">var</span> previousMarionette = root.Marionette;

  <span class="hljs-keyword">var</span> Marionette = Backbone.Marionette = {};

  Marionette.VERSION = <span class="hljs-string">'2.0.3'</span>;

  Marionette.noConflict = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    root.Marionette = previousMarionette;
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;
  };

  Backbone.Marionette = Marionette;</pre></div></div>
            
        </li>
        
        
        <li id="section-74">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-74">&#182;</a>
              </div>
              <p>Get the Deferred creator for later use</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  Marionette.Deferred = Backbone.$.Deferred;

  <span class="hljs-comment">/* jshint unused: false */</span></pre></div></div>
            
        </li>
        
        
        <li id="section-75">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-75">&#182;</a>
              </div>
              <h2 id="helpers">Helpers</h2>

            </div>
            
        </li>
        
        
        <li id="section-76">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-76">&#182;</a>
              </div>
              
            </div>
            
        </li>
        
        
        <li id="section-77">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-77">&#182;</a>
              </div>
              <p>For slicing <code>arguments</code> in functions</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  <span class="hljs-keyword">var</span> slice = <span class="hljs-built_in">Array</span>.prototype.slice;
  
  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">throwError</span>(<span class="hljs-params">message, name</span>) </span>{
    <span class="hljs-keyword">var</span> error = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(message);
    error.name = name || <span class="hljs-string">'Error'</span>;
    <span class="hljs-keyword">throw</span> error;
  }</pre></div></div>
            
        </li>
        
        
        <li id="section-78">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-78">&#182;</a>
              </div>
              <h2 id="marionette-extend">Marionette.extend</h2>

            </div>
            
        </li>
        
        
        <li id="section-79">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-79">&#182;</a>
              </div>
              
            </div>
            
        </li>
        
        
        <li id="section-80">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-80">&#182;</a>
              </div>
              <p>Borrow the Backbone <code>extend</code> method so we can use it as needed</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  Marionette.extend = Backbone.Model.extend;</pre></div></div>
            
        </li>
        
        
        <li id="section-81">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-81">&#182;</a>
              </div>
              <h2 id="marionette-getoption">Marionette.getOption</h2>

            </div>
            
        </li>
        
        
        <li id="section-82">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-82">&#182;</a>
              </div>
              
            </div>
            
        </li>
        
        
        <li id="section-83">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-83">&#182;</a>
              </div>
              <p>Retrieve an object, function or other value from a target
object or its <code>options</code>, with <code>options</code> taking precedence.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  Marionette.getOption = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">target, optionName</span>) </span>{
    <span class="hljs-keyword">if</span> (!target || !optionName) { <span class="hljs-keyword">return</span>; }
    <span class="hljs-keyword">var</span> value;
  
    <span class="hljs-keyword">if</span> (target.options &amp;&amp; (target.options[optionName] !== <span class="hljs-literal">undefined</span>)) {
      value = target.options[optionName];
    } <span class="hljs-keyword">else</span> {
      value = target[optionName];
    }
  
    <span class="hljs-keyword">return</span> value;
  };</pre></div></div>
            
        </li>
        
        
        <li id="section-84">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-84">&#182;</a>
              </div>
              <p>Proxy <code>Marionette.getOption</code></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  Marionette.proxyGetOption = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">optionName</span>) </span>{
    <span class="hljs-keyword">return</span> Marionette.getOption(<span class="hljs-keyword">this</span>, optionName);
  };</pre></div></div>
            
        </li>
        
        
        <li id="section-85">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-85">&#182;</a>
              </div>
              <h2 id="marionette-normalizemethods">Marionette.normalizeMethods</h2>

            </div>
            
        </li>
        
        
        <li id="section-86">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-86">&#182;</a>
              </div>
              
            </div>
            
        </li>
        
        
        <li id="section-87">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-87">&#182;</a>
              </div>
              <p>Pass in a mapping of events =&gt; functions or function names
and return a mapping of events =&gt; functions</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  Marionette.normalizeMethods = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">hash</span>) </span>{
    <span class="hljs-keyword">var</span> normalizedHash = {}, method;
    _.each(hash, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">fn, name</span>) </span>{
      method = fn;
      <span class="hljs-keyword">if</span> (!_.isFunction(method)) {
        method = <span class="hljs-keyword">this</span>[method];
      }
      <span class="hljs-keyword">if</span> (!method) {
        <span class="hljs-keyword">return</span>;
      }
      normalizedHash[name] = method;
    }, <span class="hljs-keyword">this</span>);
    <span class="hljs-keyword">return</span> normalizedHash;
  };</pre></div></div>
            
        </li>
        
        
        <li id="section-88">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-88">&#182;</a>
              </div>
              <p>allows for the use of the @ui. syntax within
a given key for triggers and events
swaps the @ui with the associated selector</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  Marionette.normalizeUIKeys = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">hash, ui</span>) </span>{
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span>(hash) === <span class="hljs-string">'undefined'</span>) {
      <span class="hljs-keyword">return</span>;
    }
  
    _.each(_.keys(hash), <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">v</span>) </span>{
      <span class="hljs-keyword">var</span> pattern = <span class="hljs-regexp">/@ui.[a-zA-Z_$0-9]*/g</span>;
      <span class="hljs-keyword">if</span> (v.match(pattern)) {
        hash[v.replace(pattern, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">r</span>) </span>{
          <span class="hljs-keyword">return</span> ui[r.slice(<span class="hljs-number">4</span>)];
        })] = hash[v];
        <span class="hljs-keyword">delete</span> hash[v];
      }
    });
  
    <span class="hljs-keyword">return</span> hash;
  };</pre></div></div>
            
        </li>
        
        
        <li id="section-89">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-89">&#182;</a>
              </div>
              <p>Mix in methods from Underscore, for iteration, and other
collection related features.
Borrowing this code from Backbone.Collection:
<a href="http://backbonejs.org/docs/backbone.html#section-121">http://backbonejs.org/docs/backbone.html#section-121</a></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  Marionette.actAsCollection = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">object, listProperty</span>) </span>{
    <span class="hljs-keyword">var</span> methods = [<span class="hljs-string">'forEach'</span>, <span class="hljs-string">'each'</span>, <span class="hljs-string">'map'</span>, <span class="hljs-string">'find'</span>, <span class="hljs-string">'detect'</span>, <span class="hljs-string">'filter'</span>,
      <span class="hljs-string">'select'</span>, <span class="hljs-string">'reject'</span>, <span class="hljs-string">'every'</span>, <span class="hljs-string">'all'</span>, <span class="hljs-string">'some'</span>, <span class="hljs-string">'any'</span>, <span class="hljs-string">'include'</span>,
      <span class="hljs-string">'contains'</span>, <span class="hljs-string">'invoke'</span>, <span class="hljs-string">'toArray'</span>, <span class="hljs-string">'first'</span>, <span class="hljs-string">'initial'</span>, <span class="hljs-string">'rest'</span>,
      <span class="hljs-string">'last'</span>, <span class="hljs-string">'without'</span>, <span class="hljs-string">'isEmpty'</span>, <span class="hljs-string">'pluck'</span>];
  
    _.each(methods, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">method</span>) </span>{
      object[method] = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">var</span> list = _.values(_.result(<span class="hljs-keyword">this</span>, listProperty));
        <span class="hljs-keyword">var</span> args = [list].concat(_.toArray(<span class="hljs-built_in">arguments</span>));
        <span class="hljs-keyword">return</span> _[method].apply(_, args);
      };
    });
  };</pre></div></div>
            
        </li>
        
        
        <li id="section-90">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-90">&#182;</a>
              </div>
              <p>Trigger an event and/or a corresponding method name. Examples:</p>
<p><code>this.triggerMethod(&quot;foo&quot;)</code> will trigger the “foo” event and
call the “onFoo” method.</p>
<p><code>this.triggerMethod(&quot;foo:bar&quot;)</code> will trigger the “foo:bar” event and
call the “onFooBar” method.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  Marionette.triggerMethod = (<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{</pre></div></div>
            
        </li>
        
        
        <li id="section-91">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-91">&#182;</a>
              </div>
              <p>split the event name on the “:”</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    <span class="hljs-keyword">var</span> splitter = <span class="hljs-regexp">/(^|:)(\w)/gi</span>;</pre></div></div>
            
        </li>
        
        
        <li id="section-92">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-92">&#182;</a>
              </div>
              <p>take the event section (“section1:section2:section3”)
and turn it in to uppercase name</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getEventName</span>(<span class="hljs-params">match, prefix, eventName</span>) </span>{
      <span class="hljs-keyword">return</span> eventName.toUpperCase();
    }</pre></div></div>
            
        </li>
        
        
        <li id="section-93">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-93">&#182;</a>
              </div>
              <p>actual triggerMethod implementation</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    <span class="hljs-keyword">var</span> triggerMethod = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">event</span>) </span>{</pre></div></div>
            
        </li>
        
        
        <li id="section-94">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-94">&#182;</a>
              </div>
              <p>get the method name from the event name</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      <span class="hljs-keyword">var</span> methodName = <span class="hljs-string">'on'</span> + event.replace(splitter, getEventName);
      <span class="hljs-keyword">var</span> method = <span class="hljs-keyword">this</span>[methodName];
      <span class="hljs-keyword">var</span> result;</pre></div></div>
            
        </li>
        
        
        <li id="section-95">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-95">&#182;</a>
              </div>
              <p>call the onMethodName if it exists</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      <span class="hljs-keyword">if</span> (_.isFunction(method)) {</pre></div></div>
            
        </li>
        
        
        <li id="section-96">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-96">&#182;</a>
              </div>
              <p>pass all arguments, except the event name</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        result = method.apply(<span class="hljs-keyword">this</span>, _.tail(<span class="hljs-built_in">arguments</span>));
      }</pre></div></div>
            
        </li>
        
        
        <li id="section-97">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-97">&#182;</a>
              </div>
              <p>trigger the event, if a trigger method exists</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      <span class="hljs-keyword">if</span> (_.isFunction(<span class="hljs-keyword">this</span>.trigger)) {
        <span class="hljs-keyword">this</span>.trigger.apply(<span class="hljs-keyword">this</span>, <span class="hljs-built_in">arguments</span>);
      }
  
      <span class="hljs-keyword">return</span> result;
    };
  
    <span class="hljs-keyword">return</span> triggerMethod;
  })();</pre></div></div>
            
        </li>
        
        
        <li id="section-98">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-98">&#182;</a>
              </div>
              <h2 id="domrefresh">DOMRefresh</h2>

            </div>
            
        </li>
        
        
        <li id="section-99">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-99">&#182;</a>
              </div>
              <p>Monitor a view’s state, and after it has been rendered and shown
in the DOM, trigger a “dom:refresh” event every time it is
re-rendered.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  
  Marionette.MonitorDOMRefresh = (<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">documentElement</span>) </span>{</pre></div></div>
            
        </li>
        
        
        <li id="section-100">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-100">&#182;</a>
              </div>
              <p>track when the view has been shown in the DOM,
using a Marionette.Region (or by other means of triggering “show”)</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">handleShow</span>(<span class="hljs-params">view</span>) </span>{
      view._isShown = <span class="hljs-literal">true</span>;
      triggerDOMRefresh(view);
    }</pre></div></div>
            
        </li>
        
        
        <li id="section-101">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-101">&#182;</a>
              </div>
              <p>track when the view has been rendered</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">handleRender</span>(<span class="hljs-params">view</span>) </span>{
      view._isRendered = <span class="hljs-literal">true</span>;
      triggerDOMRefresh(view);
    }</pre></div></div>
            
        </li>
        
        
        <li id="section-102">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-102">&#182;</a>
              </div>
              <p>Trigger the “dom:refresh” event and corresponding “onDomRefresh” method</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">triggerDOMRefresh</span>(<span class="hljs-params">view</span>) </span>{
      <span class="hljs-keyword">if</span> (view._isShown &amp;&amp; view._isRendered &amp;&amp; isInDOM(view)) {
        <span class="hljs-keyword">if</span> (_.isFunction(view.triggerMethod)) {
          view.triggerMethod(<span class="hljs-string">'dom:refresh'</span>);
        }
      }
    }
  
    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">isInDOM</span>(<span class="hljs-params">view</span>) </span>{
      <span class="hljs-keyword">return</span> documentElement.contains(view.el);
    }</pre></div></div>
            
        </li>
        
        
        <li id="section-103">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-103">&#182;</a>
              </div>
              <p>Export public API</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">view</span>) </span>{
      view.listenTo(view, <span class="hljs-string">'show'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        handleShow(view);
      });
  
      view.listenTo(view, <span class="hljs-string">'render'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        handleRender(view);
      });
    };
  })(<span class="hljs-built_in">document</span>.documentElement);
  

  <span class="hljs-comment">/* jshint maxparams: 5 */</span></pre></div></div>
            
        </li>
        
        
        <li id="section-104">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-104">&#182;</a>
              </div>
              <h2 id="marionette-bindentityevents-unbindentityevents">Marionette.bindEntityEvents &amp; unbindEntityEvents</h2>

            </div>
            
        </li>
        
        
        <li id="section-105">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-105">&#182;</a>
              </div>
              <p>These methods are used to bind/unbind a backbone “entity” (collection/model)
to methods on a target object.</p>
<p>The first parameter, <code>target</code>, must have a <code>listenTo</code> method from the
EventBinder object.</p>
<p>The second parameter is the entity (Backbone.Model or Backbone.Collection)
to bind the events from.</p>
<p>The third parameter is a hash of { “event:name”: “eventHandler” }
configuration. Multiple handlers can be separated by a space. A
function can be supplied instead of a string handler name.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  
  (<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">Marionette</span>) </span>{
<span class="hljs-meta">    'use strict'</span>;</pre></div></div>
            
        </li>
        
        
        <li id="section-106">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-106">&#182;</a>
              </div>
              <p>Bind the event to handlers specified as a string of
handler names on the target object</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">bindFromStrings</span>(<span class="hljs-params">target, entity, evt, methods</span>) </span>{
      <span class="hljs-keyword">var</span> methodNames = methods.split(<span class="hljs-regexp">/\s+/</span>);
  
      _.each(methodNames, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">methodName</span>) </span>{
  
        <span class="hljs-keyword">var</span> method = target[methodName];
        <span class="hljs-keyword">if</span> (!method) {
          throwError(<span class="hljs-string">'Method "'</span> + methodName +
            <span class="hljs-string">'" was configured as an event handler, but does not exist.'</span>);
        }
  
        target.listenTo(entity, evt, method);
      });
    }</pre></div></div>
            
        </li>
        
        
        <li id="section-107">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-107">&#182;</a>
              </div>
              <p>Bind the event to a supplied callback function</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">bindToFunction</span>(<span class="hljs-params">target, entity, evt, method</span>) </span>{
      target.listenTo(entity, evt, method);
    }</pre></div></div>
            
        </li>
        
        
        <li id="section-108">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-108">&#182;</a>
              </div>
              <p>Bind the event to handlers specified as a string of
handler names on the target object</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">unbindFromStrings</span>(<span class="hljs-params">target, entity, evt, methods</span>) </span>{
      <span class="hljs-keyword">var</span> methodNames = methods.split(<span class="hljs-regexp">/\s+/</span>);
  
      _.each(methodNames, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">methodName</span>) </span>{
        <span class="hljs-keyword">var</span> method = target[methodName];
        target.stopListening(entity, evt, method);
      });
    }</pre></div></div>
            
        </li>
        
        
        <li id="section-109">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-109">&#182;</a>
              </div>
              <p>Bind the event to a supplied callback function</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">unbindToFunction</span>(<span class="hljs-params">target, entity, evt, method</span>) </span>{
      target.stopListening(entity, evt, method);
    }</pre></div></div>
            
        </li>
        
        
        <li id="section-110">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-110">&#182;</a>
              </div>
              <p>generic looping function</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">iterateEvents</span>(<span class="hljs-params">target, entity, bindings, functionCallback, stringCallback</span>) </span>{
      <span class="hljs-keyword">if</span> (!entity || !bindings) { <span class="hljs-keyword">return</span>; }</pre></div></div>
            
        </li>
        
        
        <li id="section-111">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-111">&#182;</a>
              </div>
              <p>allow the bindings to be a function</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      <span class="hljs-keyword">if</span> (_.isFunction(bindings)) {
        bindings = bindings.call(target);
      }</pre></div></div>
            
        </li>
        
        
        <li id="section-112">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-112">&#182;</a>
              </div>
              <p>iterate the bindings and bind them</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      _.each(bindings, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">methods, evt</span>) </span>{</pre></div></div>
            
        </li>
        
        
        <li id="section-113">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-113">&#182;</a>
              </div>
              <p>allow for a function as the handler,
or a list of event names as a string</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        <span class="hljs-keyword">if</span> (_.isFunction(methods)) {
          functionCallback(target, entity, evt, methods);
        } <span class="hljs-keyword">else</span> {
          stringCallback(target, entity, evt, methods);
        }
  
      });
    }</pre></div></div>
            
        </li>
        
        
        <li id="section-114">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-114">&#182;</a>
              </div>
              <p>Export Public API</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    Marionette.bindEntityEvents = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">target, entity, bindings</span>) </span>{
      iterateEvents(target, entity, bindings, bindToFunction, bindFromStrings);
    };
  
    Marionette.unbindEntityEvents = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">target, entity, bindings</span>) </span>{
      iterateEvents(target, entity, bindings, unbindToFunction, unbindFromStrings);
    };</pre></div></div>
            
        </li>
        
        
        <li id="section-115">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-115">&#182;</a>
              </div>
              <p>Proxy <code>bindEntityEvents</code></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    Marionette.proxyBindEntityEvents = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">entity, bindings</span>) </span>{
      <span class="hljs-keyword">return</span> Marionette.bindEntityEvents(<span class="hljs-keyword">this</span>, entity, bindings);
    };</pre></div></div>
            
        </li>
        
        
        <li id="section-116">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-116">&#182;</a>
              </div>
              <p>Proxy <code>unbindEntityEvents</code></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    Marionette.proxyUnbindEntityEvents = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">entity, bindings</span>) </span>{
      <span class="hljs-keyword">return</span> Marionette.unbindEntityEvents(<span class="hljs-keyword">this</span>, entity, bindings);
    };
  })(Marionette);</pre></div></div>
            
        </li>
        
        
        <li id="section-117">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-117">&#182;</a>
              </div>
              <h2 id="callbacks">Callbacks</h2>

            </div>
            
        </li>
        
        
        <li id="section-118">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-118">&#182;</a>
              </div>
              
            </div>
            
        </li>
        
        
        <li id="section-119">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-119">&#182;</a>
              </div>
              <p>A simple way of managing a collection of callbacks
and executing them at a later point in time, using jQuery’s
<code>Deferred</code> object.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  Marionette.Callbacks = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">this</span>._deferred = Marionette.Deferred();
    <span class="hljs-keyword">this</span>._callbacks = [];
  };
  
  _.extend(Marionette.Callbacks.prototype, {</pre></div></div>
            
        </li>
        
        
        <li id="section-120">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-120">&#182;</a>
              </div>
              <p>Add a callback to be executed. Callbacks added here are
guaranteed to execute, even if they are added after the
<code>run</code> method is called.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    add: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">callback, contextOverride</span>) </span>{
      <span class="hljs-keyword">var</span> promise = _.result(<span class="hljs-keyword">this</span>._deferred, <span class="hljs-string">'promise'</span>);
  
      <span class="hljs-keyword">this</span>._callbacks.push({<span class="hljs-attr">cb</span>: callback, <span class="hljs-attr">ctx</span>: contextOverride});
  
      promise.then(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">args</span>) </span>{
        <span class="hljs-keyword">if</span> (contextOverride){ args.context = contextOverride; }
        callback.call(args.context, args.options);
      });
    },</pre></div></div>
            
        </li>
        
        
        <li id="section-121">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-121">&#182;</a>
              </div>
              <p>Run all registered callbacks with the context specified.
Additional callbacks can be added after this has been run
and they will still be executed.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    run: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">options, context</span>) </span>{
      <span class="hljs-keyword">this</span>._deferred.resolve({
        <span class="hljs-attr">options</span>: options,
        <span class="hljs-attr">context</span>: context
      });
    },</pre></div></div>
            
        </li>
        
        
        <li id="section-122">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-122">&#182;</a>
              </div>
              <p>Resets the list of callbacks to be run, allowing the same list
to be run multiple times - whenever the <code>run</code> method is called.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    reset: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
      <span class="hljs-keyword">var</span> callbacks = <span class="hljs-keyword">this</span>._callbacks;
      <span class="hljs-keyword">this</span>._deferred = Marionette.Deferred();
      <span class="hljs-keyword">this</span>._callbacks = [];
  
      _.each(callbacks, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">cb</span>) </span>{
        <span class="hljs-keyword">this</span>.add(cb.cb, cb.ctx);
      }, <span class="hljs-keyword">this</span>);
    }
  });</pre></div></div>
            
        </li>
        
        
        <li id="section-123">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-123">&#182;</a>
              </div>
              <h2 id="marionette-controller">Marionette Controller</h2>

            </div>
            
        </li>
        
        
        <li id="section-124">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-124">&#182;</a>
              </div>
              <p>A multi-purpose object to use as a controller for
modules and routers, and as a mediator for workflow
and coordination of other objects, views, and more.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  Marionette.Controller = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">options</span>) </span>{
    <span class="hljs-keyword">this</span>.options = options || {};
  
    <span class="hljs-keyword">if</span> (_.isFunction(<span class="hljs-keyword">this</span>.initialize)) {
      <span class="hljs-keyword">this</span>.initialize(<span class="hljs-keyword">this</span>.options);
    }
  };
  
  Marionette.Controller.extend = Marionette.extend;</pre></div></div>
            
        </li>
        
        
        <li id="section-125">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-125">&#182;</a>
              </div>
              <h2 id="controller-methods">Controller Methods</h2>

            </div>
            
        </li>
        
        
        <li id="section-126">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-126">&#182;</a>
              </div>
              
            </div>
            
        </li>
        
        
        <li id="section-127">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-127">&#182;</a>
              </div>
              <p>Ensure it can trigger events with Backbone.Events</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  _.extend(Marionette.Controller.prototype, Backbone.Events, {
    <span class="hljs-attr">destroy</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
      <span class="hljs-keyword">var</span> args = <span class="hljs-built_in">Array</span>.prototype.slice.call(<span class="hljs-built_in">arguments</span>);
      <span class="hljs-keyword">this</span>.triggerMethod.apply(<span class="hljs-keyword">this</span>, [<span class="hljs-string">'before:destroy'</span>].concat(args));
      <span class="hljs-keyword">this</span>.triggerMethod.apply(<span class="hljs-keyword">this</span>, [<span class="hljs-string">'destroy'</span>].concat(args));
  
      <span class="hljs-keyword">this</span>.stopListening();
      <span class="hljs-keyword">this</span>.off();
    },</pre></div></div>
            
        </li>
        
        
        <li id="section-128">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-128">&#182;</a>
              </div>
              <p>import the <code>triggerMethod</code> to trigger events with corresponding
methods if the method exists</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    triggerMethod: Marionette.triggerMethod,</pre></div></div>
            
        </li>
        
        
        <li id="section-129">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-129">&#182;</a>
              </div>
              <p>Proxy <code>getOption</code> to enable getting options from this or this.options by name.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    getOption: Marionette.proxyGetOption
  
  });
  
  <span class="hljs-comment">/* jshint maxcomplexity: 10, maxstatements: 29 */</span></pre></div></div>
            
        </li>
        
        
        <li id="section-130">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-130">&#182;</a>
              </div>
              <h2 id="region">Region</h2>

            </div>
            
        </li>
        
        
        <li id="section-131">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-131">&#182;</a>
              </div>
              <p>Manage the visual regions of your composite application. See
<a href="http://lostechies.com/derickbailey/2011/12/12/composite-js-apps-regions-and-region-managers/">http://lostechies.com/derickbailey/2011/12/12/composite-js-apps-regions-and-region-managers/</a></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  
  Marionette.Region = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">options</span>) </span>{
    <span class="hljs-keyword">this</span>.options = options || {};
    <span class="hljs-keyword">this</span>.el = <span class="hljs-keyword">this</span>.getOption(<span class="hljs-string">'el'</span>);</pre></div></div>
            
        </li>
        
        
        <li id="section-132">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-132">&#182;</a>
              </div>
              <p>Handle when this.el is passed in as a $ wrapped element.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    <span class="hljs-keyword">this</span>.el = <span class="hljs-keyword">this</span>.el <span class="hljs-keyword">instanceof</span> Backbone.$ ? <span class="hljs-keyword">this</span>.el[<span class="hljs-number">0</span>] : <span class="hljs-keyword">this</span>.el;
  
    <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">this</span>.el) {
      throwError(<span class="hljs-string">'An "el" must be specified for a region.'</span>, <span class="hljs-string">'NoElError'</span>);
    }
  
    <span class="hljs-keyword">this</span>.$el = <span class="hljs-keyword">this</span>.getEl(<span class="hljs-keyword">this</span>.el);
  
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.initialize) {
      <span class="hljs-keyword">var</span> args = <span class="hljs-built_in">Array</span>.prototype.slice.apply(<span class="hljs-built_in">arguments</span>);
      <span class="hljs-keyword">this</span>.initialize.apply(<span class="hljs-keyword">this</span>, args);
    }
  };</pre></div></div>
            
        </li>
        
        
        <li id="section-133">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-133">&#182;</a>
              </div>
              <h2 id="region-class-methods">Region Class methods</h2>

            </div>
            
        </li>
        
        
        <li id="section-134">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-134">&#182;</a>
              </div>
              
            </div>
            
            <div class="content"><div class='highlight'><pre>  
  _.extend(Marionette.Region, {</pre></div></div>
            
        </li>
        
        
        <li id="section-135">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-135">&#182;</a>
              </div>
              <p>Build an instance of a region by passing in a configuration object
and a default region class to use if none is specified in the config.</p>
<p>The config object should either be a string as a jQuery DOM selector,
a Region class directly, or an object literal that specifies both
a selector and regionClass:</p>
<pre><code class="lang-js">{
  <span class="hljs-attr">selector</span>: <span class="hljs-string">"#foo"</span>,
  <span class="hljs-attr">regionClass</span>: MyCustomRegion
}
</code></pre>

            </div>
            
            <div class="content"><div class='highlight'><pre>    buildRegion: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">regionConfig, defaultRegionClass</span>) </span>{
      <span class="hljs-keyword">var</span> regionIsString = _.isString(regionConfig);
      <span class="hljs-keyword">var</span> regionSelectorIsString = _.isString(regionConfig.selector);
      <span class="hljs-keyword">var</span> regionClassIsUndefined = _.isUndefined(regionConfig.regionClass);
      <span class="hljs-keyword">var</span> regionIsClass = _.isFunction(regionConfig);
  
      <span class="hljs-keyword">if</span> (!regionIsClass &amp;&amp; !regionIsString &amp;&amp; !regionSelectorIsString) {
        throwError(<span class="hljs-string">'Region must be specified as a Region class,'</span> +
          <span class="hljs-string">'a selector string or an object with selector property'</span>);
      }
  
      <span class="hljs-keyword">var</span> selector, RegionClass;</pre></div></div>
            
        </li>
        
        
        <li id="section-136">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-136">&#182;</a>
              </div>
              <p>get the selector for the region</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  
      <span class="hljs-keyword">if</span> (regionIsString) {
        selector = regionConfig;
      }
  
      <span class="hljs-keyword">if</span> (regionConfig.selector) {
        selector = regionConfig.selector;
        <span class="hljs-keyword">delete</span> regionConfig.selector;
      }</pre></div></div>
            
        </li>
        
        
        <li id="section-137">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-137">&#182;</a>
              </div>
              <p>get the class for the region</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  
      <span class="hljs-keyword">if</span> (regionIsClass) {
        RegionClass = regionConfig;
      }
  
      <span class="hljs-keyword">if</span> (!regionIsClass &amp;&amp; regionClassIsUndefined) {
        RegionClass = defaultRegionClass;
      }
  
      <span class="hljs-keyword">if</span> (regionConfig.regionClass) {
        RegionClass = regionConfig.regionClass;
        <span class="hljs-keyword">delete</span> regionConfig.regionClass;
      }
  
      <span class="hljs-keyword">if</span> (regionIsString || regionIsClass) {
        regionConfig = {};
      }
  
      regionConfig.el = selector;</pre></div></div>
            
        </li>
        
        
        <li id="section-138">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-138">&#182;</a>
              </div>
              <p>build the region instance</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      <span class="hljs-keyword">var</span> region = <span class="hljs-keyword">new</span> RegionClass(regionConfig);</pre></div></div>
            
        </li>
        
        
        <li id="section-139">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-139">&#182;</a>
              </div>
              <p>override the <code>getEl</code> function if we have a parentEl
this must be overridden to ensure the selector is found
on the first use of the region. if we try to assign the
region’s <code>el</code> to <code>parentEl.find(selector)</code> in the object
literal to build the region, the element will not be
guaranteed to be in the DOM already, and will cause problems</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      <span class="hljs-keyword">if</span> (regionConfig.parentEl) {
        region.getEl = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">el</span>) </span>{
          <span class="hljs-keyword">if</span> (_.isObject(el)) {
            <span class="hljs-keyword">return</span> Backbone.$(el);
          }
          <span class="hljs-keyword">var</span> parentEl = regionConfig.parentEl;
          <span class="hljs-keyword">if</span> (_.isFunction(parentEl)) {
            parentEl = parentEl();
          }
          <span class="hljs-keyword">return</span> parentEl.find(el);
        };
      }
  
      <span class="hljs-keyword">return</span> region;
    }
  
  });</pre></div></div>
            
        </li>
        
        
        <li id="section-140">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-140">&#182;</a>
              </div>
              <h2 id="region-instance-methods">Region Instance Methods</h2>

            </div>
            
        </li>
        
        
        <li id="section-141">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-141">&#182;</a>
              </div>
              
            </div>
            
            <div class="content"><div class='highlight'><pre>  
  _.extend(Marionette.Region.prototype, Backbone.Events, {</pre></div></div>
            
        </li>
        
        
        <li id="section-142">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-142">&#182;</a>
              </div>
              <p>Displays a backbone view instance inside of the region.
Handles calling the <code>render</code> method for you. Reads content
directly from the <code>el</code> attribute. Also calls an optional
<code>onShow</code> and <code>onDestroy</code> method on your view, just after showing
or just before destroying the view, respectively.
The <code>preventDestroy</code> option can be used to prevent a view from
the old view being destroyed on show.
The <code>forceShow</code> option can be used to force a view to be
re-rendered if it’s already shown in the region.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  
    show: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">view, options</span>)</span>{
      <span class="hljs-keyword">this</span>._ensureElement();
  
      <span class="hljs-keyword">var</span> showOptions = options || {};
      <span class="hljs-keyword">var</span> isDifferentView = view !== <span class="hljs-keyword">this</span>.currentView;
      <span class="hljs-keyword">var</span> preventDestroy =  !!showOptions.preventDestroy;
      <span class="hljs-keyword">var</span> forceShow = !!showOptions.forceShow;</pre></div></div>
            
        </li>
        
        
        <li id="section-143">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-143">&#182;</a>
              </div>
              <p>we are only changing the view if there is a view to change to begin with</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      <span class="hljs-keyword">var</span> isChangingView = !!<span class="hljs-keyword">this</span>.currentView;</pre></div></div>
            
        </li>
        
        
        <li id="section-144">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-144">&#182;</a>
              </div>
              <p>only destroy the view if we don’t want to preventDestroy and the view is different</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      <span class="hljs-keyword">var</span> _shouldDestroyView = !preventDestroy &amp;&amp; isDifferentView;
  
      <span class="hljs-keyword">if</span> (_shouldDestroyView) {
        <span class="hljs-keyword">this</span>.empty();
      }</pre></div></div>
            
        </li>
        
        
        <li id="section-145">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-145">&#182;</a>
              </div>
              <p>show the view if the view is different or if you want to re-show the view</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      <span class="hljs-keyword">var</span> _shouldShowView = isDifferentView || forceShow;
  
      <span class="hljs-keyword">if</span> (_shouldShowView) {</pre></div></div>
            
        </li>
        
        
        <li id="section-146">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-146">&#182;</a>
              </div>
              <p>We need to listen for if a view is destroyed
in a way other than through the region.
If this happens we need to remove the reference
to the currentView since once a view has been destroyed
we can not reuse it.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        view.once(<span class="hljs-string">'destroy'</span>, _.bind(<span class="hljs-keyword">this</span>.empty, <span class="hljs-keyword">this</span>));
        view.render();
  
        <span class="hljs-keyword">if</span> (isChangingView) {
          <span class="hljs-keyword">this</span>.triggerMethod(<span class="hljs-string">'before:swap'</span>, view);
        }
  
        <span class="hljs-keyword">this</span>.triggerMethod(<span class="hljs-string">'before:show'</span>, view);
  
        <span class="hljs-keyword">if</span> (_.isFunction(view.triggerMethod)) {
          view.triggerMethod(<span class="hljs-string">'before:show'</span>);
        } <span class="hljs-keyword">else</span> {
          <span class="hljs-keyword">this</span>.triggerMethod.call(view, <span class="hljs-string">'before:show'</span>);
        }
  
        <span class="hljs-keyword">this</span>.attachHtml(view);
        <span class="hljs-keyword">this</span>.currentView = view;
  
        <span class="hljs-keyword">if</span> (isChangingView) {
          <span class="hljs-keyword">this</span>.triggerMethod(<span class="hljs-string">'swap'</span>, view);
        }
  
        <span class="hljs-keyword">this</span>.triggerMethod(<span class="hljs-string">'show'</span>, view);
  
        <span class="hljs-keyword">if</span> (_.isFunction(view.triggerMethod)) {
          view.triggerMethod(<span class="hljs-string">'show'</span>);
        } <span class="hljs-keyword">else</span> {
          <span class="hljs-keyword">this</span>.triggerMethod.call(view, <span class="hljs-string">'show'</span>);
        }
  
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;
      }
  
      <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;
    },
  
    <span class="hljs-attr">_ensureElement</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>{
      <span class="hljs-keyword">if</span> (!_.isObject(<span class="hljs-keyword">this</span>.el)) {
        <span class="hljs-keyword">this</span>.$el = <span class="hljs-keyword">this</span>.getEl(<span class="hljs-keyword">this</span>.el);
        <span class="hljs-keyword">this</span>.el = <span class="hljs-keyword">this</span>.$el[<span class="hljs-number">0</span>];
      }
  
      <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">this</span>.$el || <span class="hljs-keyword">this</span>.$el.length === <span class="hljs-number">0</span>) {
        throwError(<span class="hljs-string">'An "el" '</span> + <span class="hljs-keyword">this</span>.$el.selector + <span class="hljs-string">' must exist in DOM'</span>);
      }
    },</pre></div></div>
            
        </li>
        
        
        <li id="section-147">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-147">&#182;</a>
              </div>
              <p>Override this method to change how the region finds the
DOM element that it manages. Return a jQuery selector object.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    getEl: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">el</span>) </span>{
      <span class="hljs-keyword">return</span> Backbone.$(el);
    },</pre></div></div>
            
        </li>
        
        
        <li id="section-148">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-148">&#182;</a>
              </div>
              <p>Override this method to change how the new view is
appended to the <code>$el</code> that the region is managing</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    attachHtml: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">view</span>) </span>{</pre></div></div>
            
        </li>
        
        
        <li id="section-149">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-149">&#182;</a>
              </div>
              <p>empty the node and append new view</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      <span class="hljs-keyword">this</span>.el.innerHTML=<span class="hljs-string">''</span>;
      <span class="hljs-keyword">this</span>.el.appendChild(view.el);
    },</pre></div></div>
            
        </li>
        
        
        <li id="section-150">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-150">&#182;</a>
              </div>
              <p>Destroy the current view, if there is one. If there is no
current view, it does nothing and returns immediately.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    empty: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
      <span class="hljs-keyword">var</span> view = <span class="hljs-keyword">this</span>.currentView;</pre></div></div>
            
        </li>
        
        
        <li id="section-151">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-151">&#182;</a>
              </div>
              <p>If there is no view in the region
we should not remove anything</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      <span class="hljs-keyword">if</span> (!view) { <span class="hljs-keyword">return</span>; }
  
      <span class="hljs-keyword">this</span>.triggerMethod(<span class="hljs-string">'before:empty'</span>, view);
      <span class="hljs-keyword">this</span>._destroyView();
      <span class="hljs-keyword">this</span>.triggerMethod(<span class="hljs-string">'empty'</span>, view);</pre></div></div>
            
        </li>
        
        
        <li id="section-152">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-152">&#182;</a>
              </div>
              <p>Remove region pointer to the currentView</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      <span class="hljs-keyword">delete</span> <span class="hljs-keyword">this</span>.currentView;
    },</pre></div></div>
            
        </li>
        
        
        <li id="section-153">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-153">&#182;</a>
              </div>
              <p>call ‘destroy’ or ‘remove’, depending on which is found
on the view (if showing a raw Backbone view or a Marionette View)</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    _destroyView: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
      <span class="hljs-keyword">var</span> view = <span class="hljs-keyword">this</span>.currentView;
  
      <span class="hljs-keyword">if</span> (view.destroy &amp;&amp; !view.isDestroyed) {
        view.destroy();
      } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (view.remove) {
        view.remove();
      }
    },</pre></div></div>
            
        </li>
        
        
        <li id="section-154">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-154">&#182;</a>
              </div>
              <p>Attach an existing view to the region. This
will not call <code>render</code> or <code>onShow</code> for the new view,
and will not replace the current HTML for the <code>el</code>
of the region.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    attachView: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">view</span>) </span>{
      <span class="hljs-keyword">this</span>.currentView = view;
    },</pre></div></div>
            
        </li>
        
        
        <li id="section-155">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-155">&#182;</a>
              </div>
              <p>Reset the region by destroying any existing view and
clearing out the cached <code>$el</code>. The next time a view
is shown via this region, the region will re-query the
DOM for the region’s <code>el</code>.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    reset: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
      <span class="hljs-keyword">this</span>.empty();
  
      <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.$el) {
        <span class="hljs-keyword">this</span>.el = <span class="hljs-keyword">this</span>.$el.selector;
      }
  
      <span class="hljs-keyword">delete</span> <span class="hljs-keyword">this</span>.$el;
    },</pre></div></div>
            
        </li>
        
        
        <li id="section-156">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-156">&#182;</a>
              </div>
              <p>Proxy <code>getOption</code> to enable getting options from this or this.options by name.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    getOption: Marionette.proxyGetOption,</pre></div></div>
            
        </li>
        
        
        <li id="section-157">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-157">&#182;</a>
              </div>
              <p>import the <code>triggerMethod</code> to trigger events with corresponding
methods if the method exists</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    triggerMethod: Marionette.triggerMethod
  });</pre></div></div>
            
        </li>
        
        
        <li id="section-158">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-158">&#182;</a>
              </div>
              <p>Copy the <code>extend</code> function used by Backbone’s classes</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  Marionette.Region.extend = Marionette.extend;</pre></div></div>
            
        </li>
        
        
        <li id="section-159">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-159">&#182;</a>
              </div>
              <h2 id="marionette-regionmanager">Marionette.RegionManager</h2>

            </div>
            
        </li>
        
        
        <li id="section-160">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-160">&#182;</a>
              </div>
              <p>Manage one or more related <code>Marionette.Region</code> objects.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  Marionette.RegionManager = (<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">Marionette</span>) </span>{
  
    <span class="hljs-keyword">var</span> RegionManager = Marionette.Controller.extend({
      <span class="hljs-attr">constructor</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">options</span>) </span>{
        <span class="hljs-keyword">this</span>._regions = {};
        Marionette.Controller.call(<span class="hljs-keyword">this</span>, options);
      },</pre></div></div>
            
        </li>
        
        
        <li id="section-161">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-161">&#182;</a>
              </div>
              <p>Add multiple regions using an object literal, where
each key becomes the region name, and each value is
the region definition.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      addRegions: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">regionDefinitions, defaults</span>) </span>{
        <span class="hljs-keyword">var</span> regions = {};
  
        _.each(regionDefinitions, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">definition, name</span>) </span>{
          <span class="hljs-keyword">if</span> (_.isString(definition)) {
            definition = {<span class="hljs-attr">selector</span>: definition};
          }
  
          <span class="hljs-keyword">if</span> (definition.selector) {
            definition = _.defaults({}, definition, defaults);
          }
  
          <span class="hljs-keyword">var</span> region = <span class="hljs-keyword">this</span>.addRegion(name, definition);
          regions[name] = region;
        }, <span class="hljs-keyword">this</span>);
  
        <span class="hljs-keyword">return</span> regions;
      },</pre></div></div>
            
        </li>
        
        
        <li id="section-162">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-162">&#182;</a>
              </div>
              <p>Add an individual region to the region manager,
and return the region instance</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      addRegion: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">name, definition</span>) </span>{
        <span class="hljs-keyword">var</span> region;
  
        <span class="hljs-keyword">var</span> isObject = _.isObject(definition);
        <span class="hljs-keyword">var</span> isString = _.isString(definition);
        <span class="hljs-keyword">var</span> hasSelector = !!definition.selector;
  
        <span class="hljs-keyword">if</span> (isString || (isObject &amp;&amp; hasSelector)) {
          region = Marionette.Region.buildRegion(definition, Marionette.Region);
        } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (_.isFunction(definition)) {
          region = Marionette.Region.buildRegion(definition, Marionette.Region);
        } <span class="hljs-keyword">else</span> {
          region = definition;
        }
  
        <span class="hljs-keyword">this</span>.triggerMethod(<span class="hljs-string">'before:add:region'</span>, name, region);
  
        <span class="hljs-keyword">this</span>._store(name, region);
  
        <span class="hljs-keyword">this</span>.triggerMethod(<span class="hljs-string">'add:region'</span>, name, region);
        <span class="hljs-keyword">return</span> region;
      },</pre></div></div>
            
        </li>
        
        
        <li id="section-163">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-163">&#182;</a>
              </div>
              <p>Get a region by name</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      get: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">name</span>) </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>._regions[name];
      },</pre></div></div>
            
        </li>
        
        
        <li id="section-164">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-164">&#182;</a>
              </div>
              <p>Gets all the regions contained within
the <code>regionManager</code> instance.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      getRegions: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>{
        <span class="hljs-keyword">return</span> _.clone(<span class="hljs-keyword">this</span>._regions);
      },</pre></div></div>
            
        </li>
        
        
        <li id="section-165">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-165">&#182;</a>
              </div>
              <p>Remove a region by name</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      removeRegion: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">name</span>) </span>{
        <span class="hljs-keyword">var</span> region = <span class="hljs-keyword">this</span>._regions[name];
        <span class="hljs-keyword">this</span>._remove(name, region);
      },</pre></div></div>
            
        </li>
        
        
        <li id="section-166">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-166">&#182;</a>
              </div>
              <p>Empty all regions in the region manager, and
remove them</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      removeRegions: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        _.each(<span class="hljs-keyword">this</span>._regions, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">region, name</span>) </span>{
          <span class="hljs-keyword">this</span>._remove(name, region);
        }, <span class="hljs-keyword">this</span>);
      },</pre></div></div>
            
        </li>
        
        
        <li id="section-167">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-167">&#182;</a>
              </div>
              <p>Empty all regions in the region manager, but
leave them attached</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      emptyRegions: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        _.each(<span class="hljs-keyword">this</span>._regions, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">region</span>) </span>{
          region.empty();
        }, <span class="hljs-keyword">this</span>);
      },</pre></div></div>
            
        </li>
        
        
        <li id="section-168">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-168">&#182;</a>
              </div>
              <p>Destroy all regions and shut down the region
manager entirely</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      destroy: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">this</span>.removeRegions();
        Marionette.Controller.prototype.destroy.apply(<span class="hljs-keyword">this</span>, <span class="hljs-built_in">arguments</span>);
      },</pre></div></div>
            
        </li>
        
        
        <li id="section-169">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-169">&#182;</a>
              </div>
              <p>internal method to store regions</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      _store: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">name, region</span>) </span>{
        <span class="hljs-keyword">this</span>._regions[name] = region;
        <span class="hljs-keyword">this</span>._setLength();
      },</pre></div></div>
            
        </li>
        
        
        <li id="section-170">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-170">&#182;</a>
              </div>
              <p>internal method to remove a region</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      _remove: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">name, region</span>) </span>{
        <span class="hljs-keyword">this</span>.triggerMethod(<span class="hljs-string">'before:remove:region'</span>, name, region);
        region.empty();
        region.stopListening();
        <span class="hljs-keyword">delete</span> <span class="hljs-keyword">this</span>._regions[name];
        <span class="hljs-keyword">this</span>._setLength();
        <span class="hljs-keyword">this</span>.triggerMethod(<span class="hljs-string">'remove:region'</span>, name, region);
      },</pre></div></div>
            
        </li>
        
        
        <li id="section-171">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-171">&#182;</a>
              </div>
              <p>set the number of regions current held</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      _setLength: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">this</span>.length = _.size(<span class="hljs-keyword">this</span>._regions);
      }
  
    });
  
    Marionette.actAsCollection(RegionManager.prototype, <span class="hljs-string">'_regions'</span>);
  
    <span class="hljs-keyword">return</span> RegionManager;
  })(Marionette);</pre></div></div>
            
        </li>
        
        
        <li id="section-172">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-172">&#182;</a>
              </div>
              <h2 id="template-cache">Template Cache</h2>

            </div>
            
        </li>
        
        
        <li id="section-173">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-173">&#182;</a>
              </div>
              
            </div>
            
        </li>
        
        
        <li id="section-174">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-174">&#182;</a>
              </div>
              <p>Manage templates stored in <code>&lt;script&gt;</code> blocks,
caching them for faster access.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  Marionette.TemplateCache = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">templateId</span>) </span>{
    <span class="hljs-keyword">this</span>.templateId = templateId;
  };</pre></div></div>
            
        </li>
        
        
        <li id="section-175">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-175">&#182;</a>
              </div>
              <p>TemplateCache object-level methods. Manage the template
caches from these method calls instead of creating
your own TemplateCache instances</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  _.extend(Marionette.TemplateCache, {
    <span class="hljs-attr">templateCaches</span>: {},</pre></div></div>
            
        </li>
        
        
        <li id="section-176">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-176">&#182;</a>
              </div>
              <p>Get the specified template by id. Either
retrieves the cached version, or loads it
from the DOM.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    get: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">templateId</span>) </span>{
      <span class="hljs-keyword">var</span> cachedTemplate = <span class="hljs-keyword">this</span>.templateCaches[templateId];
  
      <span class="hljs-keyword">if</span> (!cachedTemplate) {
        cachedTemplate = <span class="hljs-keyword">new</span> Marionette.TemplateCache(templateId);
        <span class="hljs-keyword">this</span>.templateCaches[templateId] = cachedTemplate;
      }
  
      <span class="hljs-keyword">return</span> cachedTemplate.load();
    },</pre></div></div>
            
        </li>
        
        
        <li id="section-177">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-177">&#182;</a>
              </div>
              <p>Clear templates from the cache. If no arguments
are specified, clears all templates:
<code>clear()</code></p>
<p>If arguments are specified, clears each of the
specified templates from the cache:
<code>clear(&quot;#t1&quot;, &quot;#t2&quot;, &quot;...&quot;)</code></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    clear: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
      <span class="hljs-keyword">var</span> i;
      <span class="hljs-keyword">var</span> args = slice.call(<span class="hljs-built_in">arguments</span>);
      <span class="hljs-keyword">var</span> length = args.length;
  
      <span class="hljs-keyword">if</span> (length &gt; <span class="hljs-number">0</span>) {
        <span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>; i &lt; length; i++) {
          <span class="hljs-keyword">delete</span> <span class="hljs-keyword">this</span>.templateCaches[args[i]];
        }
      } <span class="hljs-keyword">else</span> {
        <span class="hljs-keyword">this</span>.templateCaches = {};
      }
    }
  });</pre></div></div>
            
        </li>
        
        
        <li id="section-178">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-178">&#182;</a>
              </div>
              <p>TemplateCache instance methods, allowing each
template cache object to manage its own state
and know whether or not it has been loaded</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  _.extend(Marionette.TemplateCache.prototype, {</pre></div></div>
            
        </li>
        
        
        <li id="section-179">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-179">&#182;</a>
              </div>
              <p>Internal method to load the template</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    load: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{</pre></div></div>
            
        </li>
        
        
        <li id="section-180">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-180">&#182;</a>
              </div>
              <p>Guard clause to prevent loading this template more than once</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.compiledTemplate) {
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.compiledTemplate;
      }</pre></div></div>
            
        </li>
        
        
        <li id="section-181">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-181">&#182;</a>
              </div>
              <p>Load the template and compile it</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      <span class="hljs-keyword">var</span> template = <span class="hljs-keyword">this</span>.loadTemplate(<span class="hljs-keyword">this</span>.templateId);
      <span class="hljs-keyword">this</span>.compiledTemplate = <span class="hljs-keyword">this</span>.compileTemplate(template);
  
      <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.compiledTemplate;
    },</pre></div></div>
            
        </li>
        
        
        <li id="section-182">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-182">&#182;</a>
              </div>
              <p>Load a template from the DOM, by default. Override
this method to provide your own template retrieval
For asynchronous loading with AMD/RequireJS, consider
using a template-loader plugin as described here:
<a href="https://github.com/marionettejs/backbone.marionette/wiki/Using-marionette-with-requirejs">https://github.com/marionettejs/backbone.marionette/wiki/Using-marionette-with-requirejs</a></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    loadTemplate: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">templateId</span>) </span>{
      <span class="hljs-keyword">var</span> template = Backbone.$(templateId).html();
  
      <span class="hljs-keyword">if</span> (!template || template.length === <span class="hljs-number">0</span>) {
        throwError(<span class="hljs-string">'Could not find template: "'</span> + templateId + <span class="hljs-string">'"'</span>, <span class="hljs-string">'NoTemplateError'</span>);
      }
  
      <span class="hljs-keyword">return</span> template;
    },</pre></div></div>
            
        </li>
        
        
        <li id="section-183">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-183">&#182;</a>
              </div>
              <p>Pre-compile the template before caching it. Override
this method if you do not need to pre-compile a template
(JST / RequireJS for example) or if you want to change
the template engine used (Handebars, etc).</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    compileTemplate: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">rawTemplate</span>) </span>{
      <span class="hljs-keyword">return</span> _.template(rawTemplate);
    }
  });</pre></div></div>
            
        </li>
        
        
        <li id="section-184">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-184">&#182;</a>
              </div>
              <h2 id="renderer">Renderer</h2>

            </div>
            
        </li>
        
        
        <li id="section-185">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-185">&#182;</a>
              </div>
              
            </div>
            
        </li>
        
        
        <li id="section-186">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-186">&#182;</a>
              </div>
              <p>Render a template with data by passing in the template
selector and the data to render.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  Marionette.Renderer = {</pre></div></div>
            
        </li>
        
        
        <li id="section-187">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-187">&#182;</a>
              </div>
              <p>Render a template with data. The <code>template</code> parameter is
passed to the <code>TemplateCache</code> object to retrieve the
template function. Override this method to provide your own
custom rendering and template handling for all of Marionette.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    render: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">template, data</span>) </span>{
      <span class="hljs-keyword">if</span> (!template) {
        throwError(<span class="hljs-string">'Cannot render the template since its false, null or undefined.'</span>,
          <span class="hljs-string">'TemplateNotFoundError'</span>);
      }
  
      <span class="hljs-keyword">var</span> templateFunc;
      <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> template === <span class="hljs-string">'function'</span>) {
        templateFunc = template;
      } <span class="hljs-keyword">else</span> {
        templateFunc = Marionette.TemplateCache.get(template);
      }
  
      <span class="hljs-keyword">return</span> templateFunc(data);
    }
  };
  

  <span class="hljs-comment">/* jshint maxlen: 114, nonew: false */</span></pre></div></div>
            
        </li>
        
        
        <li id="section-188">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-188">&#182;</a>
              </div>
              <h2 id="marionette-view">Marionette.View</h2>

            </div>
            
        </li>
        
        
        <li id="section-189">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-189">&#182;</a>
              </div>
              
            </div>
            
        </li>
        
        
        <li id="section-190">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-190">&#182;</a>
              </div>
              <p>The core view class that other Marionette views extend from.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  Marionette.View = Backbone.View.extend({
  
    <span class="hljs-attr">constructor</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">options</span>) </span>{
      _.bindAll(<span class="hljs-keyword">this</span>, <span class="hljs-string">'render'</span>);</pre></div></div>
            
        </li>
        
        
        <li id="section-191">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-191">&#182;</a>
              </div>
              <p>this exposes view options to the view initializer
this is a backfill since backbone removed the assignment
of this.options
at some point however this may be removed</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      <span class="hljs-keyword">this</span>.options = _.extend({}, _.result(<span class="hljs-keyword">this</span>, <span class="hljs-string">'options'</span>), _.isFunction(options) ? options.call(<span class="hljs-keyword">this</span>) : options);</pre></div></div>
            
        </li>
        
        
        <li id="section-192">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-192">&#182;</a>
              </div>
              <p>parses out the @ui DSL for events</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      <span class="hljs-keyword">this</span>.events = <span class="hljs-keyword">this</span>.normalizeUIKeys(_.result(<span class="hljs-keyword">this</span>, <span class="hljs-string">'events'</span>));
  
      <span class="hljs-keyword">if</span> (_.isObject(<span class="hljs-keyword">this</span>.behaviors)) {
        <span class="hljs-keyword">new</span> Marionette.Behaviors(<span class="hljs-keyword">this</span>);
      }
  
      Backbone.View.apply(<span class="hljs-keyword">this</span>, <span class="hljs-built_in">arguments</span>);
  
      Marionette.MonitorDOMRefresh(<span class="hljs-keyword">this</span>);
      <span class="hljs-keyword">this</span>.listenTo(<span class="hljs-keyword">this</span>, <span class="hljs-string">'show'</span>, <span class="hljs-keyword">this</span>.onShowCalled);
    },</pre></div></div>
            
        </li>
        
        
        <li id="section-193">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-193">&#182;</a>
              </div>
              <p>Get the template for this view
instance. You can set a <code>template</code> attribute in the view
definition or pass a <code>template: &quot;whatever&quot;</code> parameter in
to the constructor options.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    getTemplate: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
      <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.getOption(<span class="hljs-string">'template'</span>);
    },</pre></div></div>
            
        </li>
        
        
        <li id="section-194">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-194">&#182;</a>
              </div>
              <p>Mix in template helper methods. Looks for a
<code>templateHelpers</code> attribute, which can either be an
object literal, or a function that returns an object
literal. All methods and attributes from this object
are copies to the object passed in.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    mixinTemplateHelpers: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">target</span>) </span>{
      target = target || {};
      <span class="hljs-keyword">var</span> templateHelpers = <span class="hljs-keyword">this</span>.getOption(<span class="hljs-string">'templateHelpers'</span>);
      <span class="hljs-keyword">if</span> (_.isFunction(templateHelpers)) {
        templateHelpers = templateHelpers.call(<span class="hljs-keyword">this</span>);
      }
      <span class="hljs-keyword">return</span> _.extend(target, templateHelpers);
    },
  
  
    <span class="hljs-attr">normalizeUIKeys</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">hash</span>) </span>{
      <span class="hljs-keyword">var</span> ui = _.result(<span class="hljs-keyword">this</span>, <span class="hljs-string">'ui'</span>);
      <span class="hljs-keyword">var</span> uiBindings = _.result(<span class="hljs-keyword">this</span>, <span class="hljs-string">'_uiBindings'</span>);
      <span class="hljs-keyword">return</span> Marionette.normalizeUIKeys(hash, uiBindings || ui);
    },</pre></div></div>
            
        </li>
        
        
        <li id="section-195">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-195">&#182;</a>
              </div>
              <p>Configure <code>triggers</code> to forward DOM events to view
events. <code>triggers: {&quot;click .foo&quot;: &quot;do:foo&quot;}</code></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    configureTriggers: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
      <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">this</span>.triggers) { <span class="hljs-keyword">return</span>; }
  
      <span class="hljs-keyword">var</span> triggerEvents = {};</pre></div></div>
            
        </li>
        
        
        <li id="section-196">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-196">&#182;</a>
              </div>
              <p>Allow <code>triggers</code> to be configured as a function</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      <span class="hljs-keyword">var</span> triggers = <span class="hljs-keyword">this</span>.normalizeUIKeys(_.result(<span class="hljs-keyword">this</span>, <span class="hljs-string">'triggers'</span>));</pre></div></div>
            
        </li>
        
        
        <li id="section-197">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-197">&#182;</a>
              </div>
              <p>Configure the triggers, prevent default
action and stop propagation of DOM events</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      _.each(triggers, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">value, key</span>) </span>{
  
        <span class="hljs-keyword">var</span> hasOptions = _.isObject(value);
        <span class="hljs-keyword">var</span> eventName = hasOptions ? value.event : value;</pre></div></div>
            
        </li>
        
        
        <li id="section-198">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-198">&#182;</a>
              </div>
              <p>build the event handler function for the DOM event</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        triggerEvents[key] = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">e</span>) </span>{</pre></div></div>
            
        </li>
        
        
        <li id="section-199">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-199">&#182;</a>
              </div>
              <p>stop the event in its tracks</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>          <span class="hljs-keyword">if</span> (e) {
            <span class="hljs-keyword">var</span> prevent = e.preventDefault;
            <span class="hljs-keyword">var</span> stop = e.stopPropagation;
  
            <span class="hljs-keyword">var</span> shouldPrevent = hasOptions ? value.preventDefault : prevent;
            <span class="hljs-keyword">var</span> shouldStop = hasOptions ? value.stopPropagation : stop;
  
            <span class="hljs-keyword">if</span> (shouldPrevent &amp;&amp; prevent) { prevent.apply(e); }
            <span class="hljs-keyword">if</span> (shouldStop &amp;&amp; stop) { stop.apply(e); }
          }</pre></div></div>
            
        </li>
        
        
        <li id="section-200">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-200">&#182;</a>
              </div>
              <p>build the args for the event</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>          <span class="hljs-keyword">var</span> args = {
            <span class="hljs-attr">view</span>: <span class="hljs-keyword">this</span>,
            <span class="hljs-attr">model</span>: <span class="hljs-keyword">this</span>.model,
            <span class="hljs-attr">collection</span>: <span class="hljs-keyword">this</span>.collection
          };</pre></div></div>
            
        </li>
        
        
        <li id="section-201">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-201">&#182;</a>
              </div>
              <p>trigger the event</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>          <span class="hljs-keyword">this</span>.triggerMethod(eventName, args);
        };
  
      }, <span class="hljs-keyword">this</span>);
  
      <span class="hljs-keyword">return</span> triggerEvents;
    },</pre></div></div>
            
        </li>
        
        
        <li id="section-202">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-202">&#182;</a>
              </div>
              <p>Overriding Backbone.View’s delegateEvents to handle
the <code>triggers</code>, <code>modelEvents</code>, and <code>collectionEvents</code> configuration</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    delegateEvents: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">events</span>) </span>{
      <span class="hljs-keyword">this</span>._delegateDOMEvents(events);
      <span class="hljs-keyword">this</span>.bindEntityEvents(<span class="hljs-keyword">this</span>.model, <span class="hljs-keyword">this</span>.getOption(<span class="hljs-string">'modelEvents'</span>));
      <span class="hljs-keyword">this</span>.bindEntityEvents(<span class="hljs-keyword">this</span>.collection, <span class="hljs-keyword">this</span>.getOption(<span class="hljs-string">'collectionEvents'</span>));
    },</pre></div></div>
            
        </li>
        
        
        <li id="section-203">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-203">&#182;</a>
              </div>
              <p>internal method to delegate DOM events and triggers</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    _delegateDOMEvents: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">events</span>) </span>{
      events = events || <span class="hljs-keyword">this</span>.events;
      <span class="hljs-keyword">if</span> (_.isFunction(events)) { events = events.call(<span class="hljs-keyword">this</span>); }</pre></div></div>
            
        </li>
        
        
        <li id="section-204">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-204">&#182;</a>
              </div>
              <p>normalize ui keys</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      events = <span class="hljs-keyword">this</span>.normalizeUIKeys(events);
  
      <span class="hljs-keyword">var</span> combinedEvents = {};</pre></div></div>
            
        </li>
        
        
        <li id="section-205">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-205">&#182;</a>
              </div>
              <p>look up if this view has behavior events</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      <span class="hljs-keyword">var</span> behaviorEvents = _.result(<span class="hljs-keyword">this</span>, <span class="hljs-string">'behaviorEvents'</span>) || {};
      <span class="hljs-keyword">var</span> triggers = <span class="hljs-keyword">this</span>.configureTriggers();</pre></div></div>
            
        </li>
        
        
        <li id="section-206">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-206">&#182;</a>
              </div>
              <p>behavior events will be overriden by view events and or triggers</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      _.extend(combinedEvents, behaviorEvents, events, triggers);
  
      Backbone.View.prototype.delegateEvents.call(<span class="hljs-keyword">this</span>, combinedEvents);
    },</pre></div></div>
            
        </li>
        
        
        <li id="section-207">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-207">&#182;</a>
              </div>
              <p>Overriding Backbone.View’s undelegateEvents to handle unbinding
the <code>triggers</code>, <code>modelEvents</code>, and <code>collectionEvents</code> config</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    undelegateEvents: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
      <span class="hljs-keyword">var</span> args = <span class="hljs-built_in">Array</span>.prototype.slice.call(<span class="hljs-built_in">arguments</span>);
      Backbone.View.prototype.undelegateEvents.apply(<span class="hljs-keyword">this</span>, args);
      <span class="hljs-keyword">this</span>.unbindEntityEvents(<span class="hljs-keyword">this</span>.model, <span class="hljs-keyword">this</span>.getOption(<span class="hljs-string">'modelEvents'</span>));
      <span class="hljs-keyword">this</span>.unbindEntityEvents(<span class="hljs-keyword">this</span>.collection, <span class="hljs-keyword">this</span>.getOption(<span class="hljs-string">'collectionEvents'</span>));
    },</pre></div></div>
            
        </li>
        
        
        <li id="section-208">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-208">&#182;</a>
              </div>
              <p>Internal method, handles the <code>show</code> event.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    onShowCalled: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{},</pre></div></div>
            
        </li>
        
        
        <li id="section-209">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-209">&#182;</a>
              </div>
              <p>Internal helper method to verify whether the view hasn’t been destroyed</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    _ensureViewIsIntact: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
      <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.isDestroyed) {
        <span class="hljs-keyword">var</span> err = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">'Cannot use a view thats already been destroyed.'</span>);
        err.name = <span class="hljs-string">'ViewDestroyedError'</span>;
        <span class="hljs-keyword">throw</span> err;
      }
    },</pre></div></div>
            
        </li>
        
        
        <li id="section-210">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-210">&#182;</a>
              </div>
              <p>Default <code>destroy</code> implementation, for removing a view from the
DOM and unbinding it. Regions will call this method
for you. You can specify an <code>onDestroy</code> method in your view to
add custom code that is called after the view is destroyed.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    destroy: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
      <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.isDestroyed) { <span class="hljs-keyword">return</span>; }
  
      <span class="hljs-keyword">var</span> args = <span class="hljs-built_in">Array</span>.prototype.slice.call(<span class="hljs-built_in">arguments</span>);
  
      <span class="hljs-keyword">this</span>.triggerMethod.apply(<span class="hljs-keyword">this</span>, [<span class="hljs-string">'before:destroy'</span>].concat(args));</pre></div></div>
            
        </li>
        
        
        <li id="section-211">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-211">&#182;</a>
              </div>
              <p>mark as destroyed before doing the actual destroy, to
prevent infinite loops within “destroy” event handlers
that are trying to destroy other views</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      <span class="hljs-keyword">this</span>.isDestroyed = <span class="hljs-literal">true</span>;
      <span class="hljs-keyword">this</span>.triggerMethod.apply(<span class="hljs-keyword">this</span>, [<span class="hljs-string">'destroy'</span>].concat(args));</pre></div></div>
            
        </li>
        
        
        <li id="section-212">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-212">&#182;</a>
              </div>
              <p>unbind UI elements</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      <span class="hljs-keyword">this</span>.unbindUIElements();</pre></div></div>
            
        </li>
        
        
        <li id="section-213">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-213">&#182;</a>
              </div>
              <p>remove the view from the DOM</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      <span class="hljs-keyword">this</span>.remove();
    },</pre></div></div>
            
        </li>
        
        
        <li id="section-214">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-214">&#182;</a>
              </div>
              <p>This method binds the elements specified in the “ui” hash inside the view’s code with
the associated jQuery selectors.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    bindUIElements: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
      <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">this</span>.ui) { <span class="hljs-keyword">return</span>; }</pre></div></div>
            
        </li>
        
        
        <li id="section-215">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-215">&#182;</a>
              </div>
              <p>store the ui hash in _uiBindings so they can be reset later
and so re-rendering the view will be able to find the bindings</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">this</span>._uiBindings) {
        <span class="hljs-keyword">this</span>._uiBindings = <span class="hljs-keyword">this</span>.ui;
      }</pre></div></div>
            
        </li>
        
        
        <li id="section-216">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-216">&#182;</a>
              </div>
              <p>get the bindings result, as a function or otherwise</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      <span class="hljs-keyword">var</span> bindings = _.result(<span class="hljs-keyword">this</span>, <span class="hljs-string">'_uiBindings'</span>);</pre></div></div>
            
        </li>
        
        
        <li id="section-217">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-217">&#182;</a>
              </div>
              <p>empty the ui so we don’t have anything to start with</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      <span class="hljs-keyword">this</span>.ui = {};</pre></div></div>
            
        </li>
        
        
        <li id="section-218">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-218">&#182;</a>
              </div>
              <p>bind each of the selectors</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      _.each(_.keys(bindings), <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">key</span>) </span>{
        <span class="hljs-keyword">var</span> selector = bindings[key];
        <span class="hljs-keyword">this</span>.ui[key] = <span class="hljs-keyword">this</span>.$(selector);
      }, <span class="hljs-keyword">this</span>);
    },</pre></div></div>
            
        </li>
        
        
        <li id="section-219">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-219">&#182;</a>
              </div>
              <p>This method unbinds the elements specified in the “ui” hash</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    unbindUIElements: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
      <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">this</span>.ui || !<span class="hljs-keyword">this</span>._uiBindings) { <span class="hljs-keyword">return</span>; }</pre></div></div>
            
        </li>
        
        
        <li id="section-220">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-220">&#182;</a>
              </div>
              <p>delete all of the existing ui bindings</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      _.each(<span class="hljs-keyword">this</span>.ui, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">$el, name</span>) </span>{
        <span class="hljs-keyword">delete</span> <span class="hljs-keyword">this</span>.ui[name];
      }, <span class="hljs-keyword">this</span>);</pre></div></div>
            
        </li>
        
        
        <li id="section-221">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-221">&#182;</a>
              </div>
              <p>reset the ui element to the original bindings configuration</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      <span class="hljs-keyword">this</span>.ui = <span class="hljs-keyword">this</span>._uiBindings;
      <span class="hljs-keyword">delete</span> <span class="hljs-keyword">this</span>._uiBindings;
    },</pre></div></div>
            
        </li>
        
        
        <li id="section-222">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-222">&#182;</a>
              </div>
              <p>import the <code>triggerMethod</code> to trigger events with corresponding
methods if the method exists</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    triggerMethod: Marionette.triggerMethod,</pre></div></div>
            
        </li>
        
        
        <li id="section-223">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-223">&#182;</a>
              </div>
              <p>Imports the “normalizeMethods” to transform hashes of
events=&gt;function references/names to a hash of events=&gt;function references</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    normalizeMethods: Marionette.normalizeMethods,</pre></div></div>
            
        </li>
        
        
        <li id="section-224">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-224">&#182;</a>
              </div>
              <p>Proxy <code>getOption</code> to enable getting options from this or this.options by name.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    getOption: Marionette.proxyGetOption,</pre></div></div>
            
        </li>
        
        
        <li id="section-225">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-225">&#182;</a>
              </div>
              <p>Proxy <code>unbindEntityEvents</code> to enable binding view’s events from another entity.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    bindEntityEvents: Marionette.proxyBindEntityEvents,</pre></div></div>
            
        </li>
        
        
        <li id="section-226">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-226">&#182;</a>
              </div>
              <p>Proxy <code>unbindEntityEvents</code> to enable unbinding view’s events from another entity.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    unbindEntityEvents: Marionette.proxyUnbindEntityEvents
  });</pre></div></div>
            
        </li>
        
        
        <li id="section-227">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-227">&#182;</a>
              </div>
              <h2 id="item-view">Item View</h2>

            </div>
            
        </li>
        
        
        <li id="section-228">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-228">&#182;</a>
              </div>
              
            </div>
            
        </li>
        
        
        <li id="section-229">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-229">&#182;</a>
              </div>
              <p>A single item view implementation that contains code for rendering
with underscore.js templates, serializing the view’s model or collection,
and calling several methods on extended views, such as <code>onRender</code>.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  Marionette.ItemView = Marionette.View.extend({</pre></div></div>
            
        </li>
        
        
        <li id="section-230">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-230">&#182;</a>
              </div>
              <p>Setting up the inheritance chain which allows changes to
Marionette.View.prototype.constructor which allows overriding</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    <span class="hljs-keyword">constructor</span>: function() {
      Marionette.View.apply(<span class="hljs-keyword">this</span>, <span class="hljs-built_in">arguments</span>);
    },</pre></div></div>
            
        </li>
        
        
        <li id="section-231">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-231">&#182;</a>
              </div>
              <p>Serialize the model or collection for the view. If a model is
found, <code>.toJSON()</code> is called. If a collection is found, <code>.toJSON()</code>
is also called, but is used to populate an <code>items</code> array in the
resulting data. If both are found, defaults to the model.
You can override the <code>serializeData</code> method in your own view
definition, to provide custom serialization for your view’s data.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    serializeData: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
      <span class="hljs-keyword">var</span> data = {};
  
      <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.model) {
        data = <span class="hljs-keyword">this</span>.model.toJSON();
      }
      <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.collection) {
        data = {<span class="hljs-attr">items</span>: <span class="hljs-keyword">this</span>.collection.toJSON()};
      }
  
      <span class="hljs-keyword">return</span> data;
    },</pre></div></div>
            
        </li>
        
        
        <li id="section-232">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-232">&#182;</a>
              </div>
              <p>Render the view, defaulting to underscore.js templates.
You can override this in your view definition to provide
a very specific rendering for your view. In general, though,
you should override the <code>Marionette.Renderer</code> object to
change how Marionette renders views.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    render: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
      <span class="hljs-keyword">this</span>._ensureViewIsIntact();
  
      <span class="hljs-keyword">this</span>.triggerMethod(<span class="hljs-string">'before:render'</span>, <span class="hljs-keyword">this</span>);
  
      <span class="hljs-keyword">var</span> data = <span class="hljs-keyword">this</span>.serializeData();
      data = <span class="hljs-keyword">this</span>.mixinTemplateHelpers(data);
  
      <span class="hljs-keyword">var</span> template = <span class="hljs-keyword">this</span>.getTemplate();
      <span class="hljs-keyword">var</span> html = Marionette.Renderer.render(template, data);
      <span class="hljs-keyword">this</span>.attachElContent(html);
      <span class="hljs-keyword">this</span>.bindUIElements();
  
      <span class="hljs-keyword">this</span>.triggerMethod(<span class="hljs-string">'render'</span>, <span class="hljs-keyword">this</span>);
  
      <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;
    },</pre></div></div>
            
        </li>
        
        
        <li id="section-233">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-233">&#182;</a>
              </div>
              <p>Attaches the content of a given view.
This method can be overriden to optimize rendering,
or to render in a non standard way.</p>
<p>For example, using <code>innerHTML</code> instead of <code>$el.html</code></p>
<pre><code class="lang-js">attachElContent: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">html</span>) </span>{
  <span class="hljs-keyword">this</span>.el.innerHTML = html;
  <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;
}
</code></pre>

            </div>
            
            <div class="content"><div class='highlight'><pre>    attachElContent: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">html</span>) </span>{
      <span class="hljs-keyword">this</span>.$el.html(html);
  
      <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;
    },</pre></div></div>
            
        </li>
        
        
        <li id="section-234">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-234">&#182;</a>
              </div>
              <p>Override the default destroy event to add a few
more events that are triggered.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    destroy: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
      <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.isDestroyed) { <span class="hljs-keyword">return</span>; }
  
      Marionette.View.prototype.destroy.apply(<span class="hljs-keyword">this</span>, <span class="hljs-built_in">arguments</span>);
    }
  });
  
  <span class="hljs-comment">/* jshint maxstatements: 14 */</span></pre></div></div>
            
        </li>
        
        
        <li id="section-235">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-235">&#182;</a>
              </div>
              <h2 id="collection-view">Collection View</h2>

            </div>
            
        </li>
        
        
        <li id="section-236">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-236">&#182;</a>
              </div>
              
            </div>
            
        </li>
        
        
        <li id="section-237">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-237">&#182;</a>
              </div>
              <p>A view that iterates over a Backbone.Collection
and renders an individual child view for each model.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  Marionette.CollectionView = Marionette.View.extend({</pre></div></div>
            
        </li>
        
        
        <li id="section-238">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-238">&#182;</a>
              </div>
              <p>used as the prefix for child view events
that are forwarded through the collectionview</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    childViewEventPrefix: <span class="hljs-string">'childview'</span>,</pre></div></div>
            
        </li>
        
        
        <li id="section-239">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-239">&#182;</a>
              </div>
              <p>constructor
option to pass <code>{sort: false}</code> to prevent the <code>CollectionView</code> from
maintaining the sorted order of the collection.
This will fallback onto appending childView’s to the end.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    <span class="hljs-keyword">constructor</span>: function(options){
      <span class="hljs-keyword">var</span> initOptions = options || {};
      <span class="hljs-keyword">this</span>.sort = _.isUndefined(initOptions.sort) ? <span class="hljs-literal">true</span> : initOptions.sort;
  
      <span class="hljs-keyword">this</span>._initChildViewStorage();
  
      Marionette.View.apply(<span class="hljs-keyword">this</span>, <span class="hljs-built_in">arguments</span>);
  
      <span class="hljs-keyword">this</span>._initialEvents();
      <span class="hljs-keyword">this</span>.initRenderBuffer();
    },</pre></div></div>
            
        </li>
        
        
        <li id="section-240">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-240">&#182;</a>
              </div>
              <p>Instead of inserting elements one by one into the page,
it’s much more performant to insert elements into a document
fragment and then insert that document fragment into the page</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    initRenderBuffer: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
      <span class="hljs-keyword">this</span>.elBuffer = <span class="hljs-built_in">document</span>.createDocumentFragment();
      <span class="hljs-keyword">this</span>._bufferedChildren = [];
    },
  
    <span class="hljs-attr">startBuffering</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
      <span class="hljs-keyword">this</span>.initRenderBuffer();
      <span class="hljs-keyword">this</span>.isBuffering = <span class="hljs-literal">true</span>;
    },
  
    <span class="hljs-attr">endBuffering</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
      <span class="hljs-keyword">this</span>.isBuffering = <span class="hljs-literal">false</span>;
      <span class="hljs-keyword">this</span>._triggerBeforeShowBufferedChildren();
      <span class="hljs-keyword">this</span>.attachBuffer(<span class="hljs-keyword">this</span>, <span class="hljs-keyword">this</span>.elBuffer);
      <span class="hljs-keyword">this</span>._triggerShowBufferedChildren();
      <span class="hljs-keyword">this</span>.initRenderBuffer();
    },
  
    <span class="hljs-attr">_triggerBeforeShowBufferedChildren</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
      <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>._isShown) {
        _.invoke(<span class="hljs-keyword">this</span>._bufferedChildren, <span class="hljs-string">'triggerMethod'</span>, <span class="hljs-string">'before:show'</span>);
      }
    },
  
    <span class="hljs-attr">_triggerShowBufferedChildren</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
      <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>._isShown) {
        _.each(<span class="hljs-keyword">this</span>._bufferedChildren, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">child</span>) </span>{
          <span class="hljs-keyword">if</span> (_.isFunction(child.triggerMethod)) {
            child.triggerMethod(<span class="hljs-string">'show'</span>);
          } <span class="hljs-keyword">else</span> {
            Marionette.triggerMethod.call(child, <span class="hljs-string">'show'</span>);
          }
        });
        <span class="hljs-keyword">this</span>._bufferedChildren = [];
      }
    },</pre></div></div>
            
        </li>
        
        
        <li id="section-241">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-241">&#182;</a>
              </div>
              <p>Configured the initial events that the collection view
binds to.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    _initialEvents: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
      <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.collection) {
        <span class="hljs-keyword">this</span>.listenTo(<span class="hljs-keyword">this</span>.collection, <span class="hljs-string">'add'</span>, <span class="hljs-keyword">this</span>._onCollectionAdd);
        <span class="hljs-keyword">this</span>.listenTo(<span class="hljs-keyword">this</span>.collection, <span class="hljs-string">'remove'</span>, <span class="hljs-keyword">this</span>._onCollectionRemove);
        <span class="hljs-keyword">this</span>.listenTo(<span class="hljs-keyword">this</span>.collection, <span class="hljs-string">'reset'</span>, <span class="hljs-keyword">this</span>.render);
  
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.sort) {
          <span class="hljs-keyword">this</span>.listenTo(<span class="hljs-keyword">this</span>.collection, <span class="hljs-string">'sort'</span>, <span class="hljs-keyword">this</span>._sortViews);
        }
      }
    },</pre></div></div>
            
        </li>
        
        
        <li id="section-242">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-242">&#182;</a>
              </div>
              <p>Handle a child added to the collection</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    _onCollectionAdd: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">child, collection, options</span>) </span>{
      <span class="hljs-keyword">this</span>.destroyEmptyView();
      <span class="hljs-keyword">var</span> ChildView = <span class="hljs-keyword">this</span>.getChildView(child);
      <span class="hljs-keyword">var</span> index = <span class="hljs-keyword">this</span>.collection.indexOf(child);
      <span class="hljs-keyword">this</span>.addChild(child, ChildView, index);
    },</pre></div></div>
            
        </li>
        
        
        <li id="section-243">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-243">&#182;</a>
              </div>
              <p>get the child view by model it holds, and remove it</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    _onCollectionRemove: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">model</span>) </span>{
      <span class="hljs-keyword">var</span> view = <span class="hljs-keyword">this</span>.children.findByModel(model);
      <span class="hljs-keyword">this</span>.removeChildView(view);
      <span class="hljs-keyword">this</span>.checkEmpty();
    },</pre></div></div>
            
        </li>
        
        
        <li id="section-244">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-244">&#182;</a>
              </div>
              <p>Override from <code>Marionette.View</code> to trigger show on child views</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    onShowCalled: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>{
      <span class="hljs-keyword">this</span>.children.each(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">child</span>)</span>{
        <span class="hljs-keyword">if</span> (_.isFunction(child.triggerMethod)) {
          child.triggerMethod(<span class="hljs-string">'show'</span>);
        } <span class="hljs-keyword">else</span> {
          Marionette.triggerMethod.call(child, <span class="hljs-string">'show'</span>);
        }
      });
    },</pre></div></div>
            
        </li>
        
        
        <li id="section-245">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-245">&#182;</a>
              </div>
              <p>Render children views. Override this method to
provide your own implementation of a render function for
the collection view.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    render: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
      <span class="hljs-keyword">this</span>._ensureViewIsIntact();
      <span class="hljs-keyword">this</span>.triggerMethod(<span class="hljs-string">'before:render'</span>, <span class="hljs-keyword">this</span>);
      <span class="hljs-keyword">this</span>._renderChildren();
      <span class="hljs-keyword">this</span>.triggerMethod(<span class="hljs-string">'render'</span>, <span class="hljs-keyword">this</span>);
      <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;
    },</pre></div></div>
            
        </li>
        
        
        <li id="section-246">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-246">&#182;</a>
              </div>
              <p>Internal method. This checks for any changes in the order of the collection.
If the index of any view doesn’t match, it will render.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    _sortViews: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>{</pre></div></div>
            
        </li>
        
        
        <li id="section-247">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-247">&#182;</a>
              </div>
              <p>check for any changes in sort order of views</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      <span class="hljs-keyword">var</span> orderChanged = <span class="hljs-keyword">this</span>.collection.find(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">item, index</span>)</span>{
        <span class="hljs-keyword">var</span> view = <span class="hljs-keyword">this</span>.children.findByModel(item);
        <span class="hljs-keyword">return</span> view &amp;&amp; view._index !== index;
      }, <span class="hljs-keyword">this</span>);
  
      <span class="hljs-keyword">if</span> (orderChanged) {
        <span class="hljs-keyword">this</span>.render();
      }
    },</pre></div></div>
            
        </li>
        
        
        <li id="section-248">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-248">&#182;</a>
              </div>
              <p>Internal method. Separated so that CompositeView can have
more control over events being triggered, around the rendering
process</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    _renderChildren: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
      <span class="hljs-keyword">this</span>.destroyEmptyView();
      <span class="hljs-keyword">this</span>.destroyChildren();
  
      <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.isEmpty(<span class="hljs-keyword">this</span>.collection)) {
        <span class="hljs-keyword">this</span>.showEmptyView();
      } <span class="hljs-keyword">else</span> {
        <span class="hljs-keyword">this</span>.triggerMethod(<span class="hljs-string">'before:render:collection'</span>, <span class="hljs-keyword">this</span>);
        <span class="hljs-keyword">this</span>.startBuffering();
        <span class="hljs-keyword">this</span>.showCollection();
        <span class="hljs-keyword">this</span>.endBuffering();
        <span class="hljs-keyword">this</span>.triggerMethod(<span class="hljs-string">'render:collection'</span>, <span class="hljs-keyword">this</span>);
      }
    },</pre></div></div>
            
        </li>
        
        
        <li id="section-249">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-249">&#182;</a>
              </div>
              <p>Internal method to loop through collection and show each child view.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    showCollection: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
      <span class="hljs-keyword">var</span> ChildView;
      <span class="hljs-keyword">this</span>.collection.each(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">child, index</span>) </span>{
        ChildView = <span class="hljs-keyword">this</span>.getChildView(child);
        <span class="hljs-keyword">this</span>.addChild(child, ChildView, index);
      }, <span class="hljs-keyword">this</span>);
    },</pre></div></div>
            
        </li>
        
        
        <li id="section-250">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-250">&#182;</a>
              </div>
              <p>Internal method to show an empty view in place of
a collection of child views, when the collection is empty</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    showEmptyView: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
      <span class="hljs-keyword">var</span> EmptyView = <span class="hljs-keyword">this</span>.getEmptyView();
  
      <span class="hljs-keyword">if</span> (EmptyView &amp;&amp; !<span class="hljs-keyword">this</span>._showingEmptyView) {
        <span class="hljs-keyword">this</span>.triggerMethod(<span class="hljs-string">'before:render:empty'</span>);
  
        <span class="hljs-keyword">this</span>._showingEmptyView = <span class="hljs-literal">true</span>;
        <span class="hljs-keyword">var</span> model = <span class="hljs-keyword">new</span> Backbone.Model();
        <span class="hljs-keyword">this</span>.addEmptyView(model, EmptyView);
  
        <span class="hljs-keyword">this</span>.triggerMethod(<span class="hljs-string">'render:empty'</span>);
      }
    },</pre></div></div>
            
        </li>
        
        
        <li id="section-251">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-251">&#182;</a>
              </div>
              <p>Internal method to destroy an existing emptyView instance
if one exists. Called when a collection view has been
rendered empty, and then a child is added to the collection.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    destroyEmptyView: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
      <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>._showingEmptyView) {
        <span class="hljs-keyword">this</span>.destroyChildren();
        <span class="hljs-keyword">delete</span> <span class="hljs-keyword">this</span>._showingEmptyView;
      }
    },</pre></div></div>
            
        </li>
        
        
        <li id="section-252">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-252">&#182;</a>
              </div>
              <p>Retrieve the empty view class</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    getEmptyView: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
      <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.getOption(<span class="hljs-string">'emptyView'</span>);
    },</pre></div></div>
            
        </li>
        
        
        <li id="section-253">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-253">&#182;</a>
              </div>
              <p>Render and show the emptyView. Similar to addChild method
but “child:added” events are not fired, and the event from
emptyView are not forwarded</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    addEmptyView: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">child, EmptyView</span>)</span>{</pre></div></div>
            
        </li>
        
        
        <li id="section-254">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-254">&#182;</a>
              </div>
              <p>get the emptyViewOptions, falling back to childViewOptions</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      <span class="hljs-keyword">var</span> emptyViewOptions = <span class="hljs-keyword">this</span>.getOption(<span class="hljs-string">'emptyViewOptions'</span>) ||
                            <span class="hljs-keyword">this</span>.getOption(<span class="hljs-string">'childViewOptions'</span>);
  
      <span class="hljs-keyword">if</span> (_.isFunction(emptyViewOptions)){
        emptyViewOptions = emptyViewOptions.call(<span class="hljs-keyword">this</span>);
      }</pre></div></div>
            
        </li>
        
        
        <li id="section-255">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-255">&#182;</a>
              </div>
              <p>build the empty view</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      <span class="hljs-keyword">var</span> view = <span class="hljs-keyword">this</span>.buildChildView(child, EmptyView, emptyViewOptions);</pre></div></div>
            
        </li>
        
        
        <li id="section-256">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-256">&#182;</a>
              </div>
              <p>trigger the ‘before:show’ event on <code>view</code> if the collection view
has already been shown</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>._isShown){
        <span class="hljs-keyword">this</span>.triggerMethod.call(view, <span class="hljs-string">'before:show'</span>);
      }</pre></div></div>
            
        </li>
        
        
        <li id="section-257">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-257">&#182;</a>
              </div>
              <p>Store the <code>emptyView</code> like a <code>childView</code> so we can properly
remove and/or close it later</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      <span class="hljs-keyword">this</span>.children.add(view);</pre></div></div>
            
        </li>
        
        
        <li id="section-258">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-258">&#182;</a>
              </div>
              <p>Render it and show it</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      <span class="hljs-keyword">this</span>.renderChildView(view, <span class="hljs-number">-1</span>);</pre></div></div>
            
        </li>
        
        
        <li id="section-259">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-259">&#182;</a>
              </div>
              <p>call the ‘show’ method if the collection view
has already been shown</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>._isShown){
        <span class="hljs-keyword">this</span>.triggerMethod.call(view, <span class="hljs-string">'show'</span>);
      }
    },</pre></div></div>
            
        </li>
        
        
        <li id="section-260">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-260">&#182;</a>
              </div>
              <p>Retrieve the childView class, either from <code>this.options.childView</code>
or from the <code>childView</code> in the object definition. The “options”
takes precedence.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    getChildView: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">child</span>) </span>{
      <span class="hljs-keyword">var</span> childView = <span class="hljs-keyword">this</span>.getOption(<span class="hljs-string">'childView'</span>);
  
      <span class="hljs-keyword">if</span> (!childView) {
        throwError(<span class="hljs-string">'A "childView" must be specified'</span>, <span class="hljs-string">'NoChildViewError'</span>);
      }
  
      <span class="hljs-keyword">return</span> childView;
    },</pre></div></div>
            
        </li>
        
        
        <li id="section-261">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-261">&#182;</a>
              </div>
              <p>Render the child’s view and add it to the
HTML for the collection view at a given index.
This will also update the indices of later views in the collection
in order to keep the children in sync with the collection.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    addChild: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">child, ChildView, index</span>) </span>{
      <span class="hljs-keyword">var</span> childViewOptions = <span class="hljs-keyword">this</span>.getOption(<span class="hljs-string">'childViewOptions'</span>);
      <span class="hljs-keyword">if</span> (_.isFunction(childViewOptions)) {
        childViewOptions = childViewOptions.call(<span class="hljs-keyword">this</span>, child, index);
      }
  
      <span class="hljs-keyword">var</span> view = <span class="hljs-keyword">this</span>.buildChildView(child, ChildView, childViewOptions);</pre></div></div>
            
        </li>
        
        
        <li id="section-262">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-262">&#182;</a>
              </div>
              <p>increment indices of views after this one</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      <span class="hljs-keyword">this</span>._updateIndices(view, <span class="hljs-literal">true</span>, index);
  
      <span class="hljs-keyword">this</span>._addChildView(view, index);
  
      <span class="hljs-keyword">return</span> view;
    },</pre></div></div>
            
        </li>
        
        
        <li id="section-263">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-263">&#182;</a>
              </div>
              <p>Internal method. This decrements or increments the indices of views after the
added/removed view to keep in sync with the collection.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    _updateIndices: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">view, increment, index</span>) </span>{
      <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">this</span>.sort) {
        <span class="hljs-keyword">return</span>;
      }
  
      <span class="hljs-keyword">if</span> (increment) {</pre></div></div>
            
        </li>
        
        
        <li id="section-264">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-264">&#182;</a>
              </div>
              <p>assign the index to the view</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        view._index = index;</pre></div></div>
            
        </li>
        
        
        <li id="section-265">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-265">&#182;</a>
              </div>
              <p>increment the index of views after this one</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        <span class="hljs-keyword">this</span>.children.each(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">laterView</span>) </span>{
          <span class="hljs-keyword">if</span> (laterView._index &gt;= view._index) {
            laterView._index++;
          }
        });
      }
      <span class="hljs-keyword">else</span> {</pre></div></div>
            
        </li>
        
        
        <li id="section-266">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-266">&#182;</a>
              </div>
              <p>decrement the index of views after this one</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        <span class="hljs-keyword">this</span>.children.each(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">laterView</span>) </span>{
          <span class="hljs-keyword">if</span> (laterView._index &gt;= view._index) {
            laterView._index--;
          }
        });
      }
    },</pre></div></div>
            
        </li>
        
        
        <li id="section-267">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-267">&#182;</a>
              </div>
              <p>Internal Method. Add the view to children and render it at
the given index.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    _addChildView: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">view, index</span>) </span>{</pre></div></div>
            
        </li>
        
        
        <li id="section-268">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-268">&#182;</a>
              </div>
              <p>set up the child view event forwarding</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      <span class="hljs-keyword">this</span>.proxyChildEvents(view);
  
      <span class="hljs-keyword">this</span>.triggerMethod(<span class="hljs-string">'before:add:child'</span>, view);</pre></div></div>
            
        </li>
        
        
        <li id="section-269">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-269">&#182;</a>
              </div>
              <p>Store the child view itself so we can properly
remove and/or destroy it later</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      <span class="hljs-keyword">this</span>.children.add(view);
      <span class="hljs-keyword">this</span>.renderChildView(view, index);
  
      <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>._isShown &amp;&amp; !<span class="hljs-keyword">this</span>.isBuffering){
        <span class="hljs-keyword">if</span> (_.isFunction(view.triggerMethod)) {
          view.triggerMethod(<span class="hljs-string">'show'</span>);
        } <span class="hljs-keyword">else</span> {
          Marionette.triggerMethod.call(view, <span class="hljs-string">'show'</span>);
        }
      }
  
      <span class="hljs-keyword">this</span>.triggerMethod(<span class="hljs-string">'add:child'</span>, view);
    },</pre></div></div>
            
        </li>
        
        
        <li id="section-270">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-270">&#182;</a>
              </div>
              <p>render the child view</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    renderChildView: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">view, index</span>) </span>{
      view.render();
      <span class="hljs-keyword">this</span>.attachHtml(<span class="hljs-keyword">this</span>, view, index);
    },</pre></div></div>
            
        </li>
        
        
        <li id="section-271">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-271">&#182;</a>
              </div>
              <p>Build a <code>childView</code> for a model in the collection.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    buildChildView: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">child, ChildViewClass, childViewOptions</span>) </span>{
      <span class="hljs-keyword">var</span> options = _.extend({<span class="hljs-attr">model</span>: child}, childViewOptions);
      <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> ChildViewClass(options);
    },</pre></div></div>
            
        </li>
        
        
        <li id="section-272">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-272">&#182;</a>
              </div>
              <p>Remove the child view and destroy it.
This function also updates the indices of
later views in the collection in order to keep
the children in sync with the collection.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    removeChildView: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">view</span>) </span>{
  
      <span class="hljs-keyword">if</span> (view) {
        <span class="hljs-keyword">this</span>.triggerMethod(<span class="hljs-string">'before:remove:child'</span>, view);</pre></div></div>
            
        </li>
        
        
        <li id="section-273">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-273">&#182;</a>
              </div>
              <p>call ‘destroy’ or ‘remove’, depending on which is found</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        <span class="hljs-keyword">if</span> (view.destroy) { view.destroy(); }
        <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (view.remove) { view.remove(); }
  
        <span class="hljs-keyword">this</span>.stopListening(view);
        <span class="hljs-keyword">this</span>.children.remove(view);
        <span class="hljs-keyword">this</span>.triggerMethod(<span class="hljs-string">'remove:child'</span>, view);</pre></div></div>
            
        </li>
        
        
        <li id="section-274">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-274">&#182;</a>
              </div>
              <p>decrement the index of views after this one</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        <span class="hljs-keyword">this</span>._updateIndices(view, <span class="hljs-literal">false</span>);
      }
  
    },</pre></div></div>
            
        </li>
        
        
        <li id="section-275">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-275">&#182;</a>
              </div>
              <p>check if the collection is empty</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    isEmpty: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">collection</span>) </span>{
      <span class="hljs-keyword">return</span> !<span class="hljs-keyword">this</span>.collection || <span class="hljs-keyword">this</span>.collection.length === <span class="hljs-number">0</span>;
    },</pre></div></div>
            
        </li>
        
        
        <li id="section-276">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-276">&#182;</a>
              </div>
              <p>If empty, show the empty view</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    checkEmpty: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
      <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.isEmpty(<span class="hljs-keyword">this</span>.collection)) {
        <span class="hljs-keyword">this</span>.showEmptyView();
      }
    },</pre></div></div>
            
        </li>
        
        
        <li id="section-277">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-277">&#182;</a>
              </div>
              <p>You might need to override this if you’ve overridden attachHtml</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    attachBuffer: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">collectionView, buffer</span>) </span>{
      collectionView.$el.append(buffer);
    },</pre></div></div>
            
        </li>
        
        
        <li id="section-278">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-278">&#182;</a>
              </div>
              <p>Append the HTML to the collection’s <code>el</code>.
Override this method to do something other
than <code>.append</code>.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    attachHtml: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">collectionView, childView, index</span>) </span>{
      <span class="hljs-keyword">if</span> (collectionView.isBuffering) {</pre></div></div>
            
        </li>
        
        
        <li id="section-279">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-279">&#182;</a>
              </div>
              <p>buffering happens on reset events and initial renders
in order to reduce the number of inserts into the
document, which are expensive.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        collectionView.elBuffer.appendChild(childView.el);
        collectionView._bufferedChildren.push(childView);
      }
      <span class="hljs-keyword">else</span> {</pre></div></div>
            
        </li>
        
        
        <li id="section-280">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-280">&#182;</a>
              </div>
              <p>If we’ve already rendered the main collection, append
the new child into the correct order if we need to. Otherwise
append to the end.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        <span class="hljs-keyword">if</span> (!collectionView._insertBefore(childView, index)){
          collectionView._insertAfter(childView);
        }
      }
    },</pre></div></div>
            
        </li>
        
        
        <li id="section-281">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-281">&#182;</a>
              </div>
              <p>Internal method. Check whether we need to insert the view into
the correct position.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    _insertBefore: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">childView, index</span>) </span>{
      <span class="hljs-keyword">var</span> currentView;
      <span class="hljs-keyword">var</span> findPosition = <span class="hljs-keyword">this</span>.sort &amp;&amp; (index &lt; <span class="hljs-keyword">this</span>.children.length - <span class="hljs-number">1</span>);
      <span class="hljs-keyword">if</span> (findPosition) {</pre></div></div>
            
        </li>
        
        
        <li id="section-282">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-282">&#182;</a>
              </div>
              <p>Find the view after this one</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        currentView = <span class="hljs-keyword">this</span>.children.find(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">view</span>) </span>{
          <span class="hljs-keyword">return</span> view._index === index + <span class="hljs-number">1</span>;
        });
      }
  
      <span class="hljs-keyword">if</span> (currentView) {
        currentView.$el.before(childView.el);
        <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
      }
  
      <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
    },</pre></div></div>
            
        </li>
        
        
        <li id="section-283">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-283">&#182;</a>
              </div>
              <p>Internal method. Append a view to the end of the $el</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    _insertAfter: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">childView</span>) </span>{
      <span class="hljs-keyword">this</span>.$el.append(childView.el);
    },</pre></div></div>
            
        </li>
        
        
        <li id="section-284">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-284">&#182;</a>
              </div>
              <p>Internal method to set up the <code>children</code> object for
storing all of the child views</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    _initChildViewStorage: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
      <span class="hljs-keyword">this</span>.children = <span class="hljs-keyword">new</span> Backbone.ChildViewContainer();
    },</pre></div></div>
            
        </li>
        
        
        <li id="section-285">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-285">&#182;</a>
              </div>
              <p>Handle cleanup and other destroying needs for the collection of views</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    destroy: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
      <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.isDestroyed) { <span class="hljs-keyword">return</span>; }
  
      <span class="hljs-keyword">this</span>.triggerMethod(<span class="hljs-string">'before:destroy:collection'</span>);
      <span class="hljs-keyword">this</span>.destroyChildren();
      <span class="hljs-keyword">this</span>.triggerMethod(<span class="hljs-string">'destroy:collection'</span>);
  
      Marionette.View.prototype.destroy.apply(<span class="hljs-keyword">this</span>, <span class="hljs-built_in">arguments</span>);
    },</pre></div></div>
            
        </li>
        
        
        <li id="section-286">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-286">&#182;</a>
              </div>
              <p>Destroy the child views that this collection view
is holding on to, if any</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    destroyChildren: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
      <span class="hljs-keyword">this</span>.children.each(<span class="hljs-keyword">this</span>.removeChildView, <span class="hljs-keyword">this</span>);
      <span class="hljs-keyword">this</span>.checkEmpty();
    },</pre></div></div>
            
        </li>
        
        
        <li id="section-287">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-287">&#182;</a>
              </div>
              <p>Set up the child view event forwarding. Uses a “childview:”
prefix in front of all forwarded events.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    proxyChildEvents: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">view</span>) </span>{
      <span class="hljs-keyword">var</span> prefix = <span class="hljs-keyword">this</span>.getOption(<span class="hljs-string">'childViewEventPrefix'</span>);</pre></div></div>
            
        </li>
        
        
        <li id="section-288">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-288">&#182;</a>
              </div>
              <p>Forward all child view events through the parent,
prepending “childview:” to the event name</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      <span class="hljs-keyword">this</span>.listenTo(view, <span class="hljs-string">'all'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">var</span> args = <span class="hljs-built_in">Array</span>.prototype.slice.call(<span class="hljs-built_in">arguments</span>);
        <span class="hljs-keyword">var</span> rootEvent = args[<span class="hljs-number">0</span>];
        <span class="hljs-keyword">var</span> childEvents = <span class="hljs-keyword">this</span>.normalizeMethods(_.result(<span class="hljs-keyword">this</span>, <span class="hljs-string">'childEvents'</span>));
  
        args[<span class="hljs-number">0</span>] = prefix + <span class="hljs-string">':'</span> + rootEvent;
        args.splice(<span class="hljs-number">1</span>, <span class="hljs-number">0</span>, view);</pre></div></div>
            
        </li>
        
        
        <li id="section-289">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-289">&#182;</a>
              </div>
              <p>call collectionView childEvent if defined</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> childEvents !== <span class="hljs-string">'undefined'</span> &amp;&amp; _.isFunction(childEvents[rootEvent])) {
          childEvents[rootEvent].apply(<span class="hljs-keyword">this</span>, args.slice(<span class="hljs-number">1</span>));
        }
  
        <span class="hljs-keyword">this</span>.triggerMethod.apply(<span class="hljs-keyword">this</span>, args);
      }, <span class="hljs-keyword">this</span>);
    }
  });
  
  <span class="hljs-comment">/* jshint maxstatements: 17, maxlen: 117 */</span></pre></div></div>
            
        </li>
        
        
        <li id="section-290">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-290">&#182;</a>
              </div>
              <h2 id="composite-view">Composite View</h2>

            </div>
            
        </li>
        
        
        <li id="section-291">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-291">&#182;</a>
              </div>
              
            </div>
            
        </li>
        
        
        <li id="section-292">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-292">&#182;</a>
              </div>
              <p>Used for rendering a branch-leaf, hierarchical structure.
Extends directly from CollectionView and also renders an
a child view as <code>modelView</code>, for the top leaf</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  Marionette.CompositeView = Marionette.CollectionView.extend({</pre></div></div>
            
        </li>
        
        
        <li id="section-293">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-293">&#182;</a>
              </div>
              <p>Setting up the inheritance chain which allows changes to
Marionette.CollectionView.prototype.constructor which allows overriding
option to pass ‘{sort: false}’ to prevent the CompositeView from
maintaining the sorted order of the collection.
This will fallback onto appending childView’s to the end.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    <span class="hljs-keyword">constructor</span>: function() {
      Marionette.CollectionView.apply(<span class="hljs-keyword">this</span>, <span class="hljs-built_in">arguments</span>);
    },</pre></div></div>
            
        </li>
        
        
        <li id="section-294">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-294">&#182;</a>
              </div>
              <p>Configured the initial events that the composite view
binds to. Override this method to prevent the initial
events, or to add your own initial events.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    _initialEvents: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{</pre></div></div>
            
        </li>
        
        
        <li id="section-295">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-295">&#182;</a>
              </div>
              <p>Bind only after composite view is rendered to avoid adding child views
to nonexistent childViewContainer</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      <span class="hljs-keyword">this</span>.once(<span class="hljs-string">'render'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.collection) {
          <span class="hljs-keyword">this</span>.listenTo(<span class="hljs-keyword">this</span>.collection, <span class="hljs-string">'add'</span>, <span class="hljs-keyword">this</span>._onCollectionAdd);
          <span class="hljs-keyword">this</span>.listenTo(<span class="hljs-keyword">this</span>.collection, <span class="hljs-string">'remove'</span>, <span class="hljs-keyword">this</span>._onCollectionRemove);
          <span class="hljs-keyword">this</span>.listenTo(<span class="hljs-keyword">this</span>.collection, <span class="hljs-string">'reset'</span>, <span class="hljs-keyword">this</span>._renderChildren);
  
          <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.sort) {
            <span class="hljs-keyword">this</span>.listenTo(<span class="hljs-keyword">this</span>.collection, <span class="hljs-string">'sort'</span>, <span class="hljs-keyword">this</span>._sortViews);
          }
        }
      });
  
    },</pre></div></div>
            
        </li>
        
        
        <li id="section-296">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-296">&#182;</a>
              </div>
              <p>Retrieve the <code>childView</code> to be used when rendering each of
the items in the collection. The default is to return
<code>this.childView</code> or Marionette.CompositeView if no <code>childView</code>
has been defined</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    getChildView: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">child</span>) </span>{
      <span class="hljs-keyword">var</span> childView = <span class="hljs-keyword">this</span>.getOption(<span class="hljs-string">'childView'</span>) || <span class="hljs-keyword">this</span>.constructor;
  
      <span class="hljs-keyword">if</span> (!childView) {
        throwError(<span class="hljs-string">'A "childView" must be specified'</span>, <span class="hljs-string">'NoChildViewError'</span>);
      }
  
      <span class="hljs-keyword">return</span> childView;
    },</pre></div></div>
            
        </li>
        
        
        <li id="section-297">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-297">&#182;</a>
              </div>
              <p>Serialize the collection for the view.
You can override the <code>serializeData</code> method in your own view
definition, to provide custom serialization for your view’s data.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    serializeData: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
      <span class="hljs-keyword">var</span> data = {};
  
      <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.model) {
        data = <span class="hljs-keyword">this</span>.model.toJSON();
      }
  
      <span class="hljs-keyword">return</span> data;
    },</pre></div></div>
            
        </li>
        
        
        <li id="section-298">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-298">&#182;</a>
              </div>
              <p>Renders the model once, and the collection once. Calling
this again will tell the model’s view to re-render itself
but the collection will not re-render.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    render: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
      <span class="hljs-keyword">this</span>._ensureViewIsIntact();
      <span class="hljs-keyword">this</span>.isRendered = <span class="hljs-literal">true</span>;
      <span class="hljs-keyword">this</span>.resetChildViewContainer();
  
      <span class="hljs-keyword">this</span>.triggerMethod(<span class="hljs-string">'before:render'</span>, <span class="hljs-keyword">this</span>);
  
      <span class="hljs-keyword">this</span>._renderRoot();
      <span class="hljs-keyword">this</span>._renderChildren();
  
      <span class="hljs-keyword">this</span>.triggerMethod(<span class="hljs-string">'render'</span>, <span class="hljs-keyword">this</span>);
      <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;
    },
  
    <span class="hljs-attr">_renderChildren</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
      <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.isRendered) {
        Marionette.CollectionView.prototype._renderChildren.call(<span class="hljs-keyword">this</span>);
      }
    },</pre></div></div>
            
        </li>
        
        
        <li id="section-299">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-299">&#182;</a>
              </div>
              <p>Render the root template that the children
views are appended to</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    _renderRoot: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
      <span class="hljs-keyword">var</span> data = {};
      data = <span class="hljs-keyword">this</span>.serializeData();
      data = <span class="hljs-keyword">this</span>.mixinTemplateHelpers(data);
  
      <span class="hljs-keyword">this</span>.triggerMethod(<span class="hljs-string">'before:render:template'</span>);
  
      <span class="hljs-keyword">var</span> template = <span class="hljs-keyword">this</span>.getTemplate();
      <span class="hljs-keyword">var</span> html = Marionette.Renderer.render(template, data);
      <span class="hljs-keyword">this</span>.attachElContent(html);</pre></div></div>
            
        </li>
        
        
        <li id="section-300">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-300">&#182;</a>
              </div>
              <p>the ui bindings is done here and not at the end of render since they
will not be available until after the model is rendered, but should be
available before the collection is rendered.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      <span class="hljs-keyword">this</span>.bindUIElements();
      <span class="hljs-keyword">this</span>.triggerMethod(<span class="hljs-string">'render:template'</span>);
    },</pre></div></div>
            
        </li>
        
        
        <li id="section-301">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-301">&#182;</a>
              </div>
              <p>Attaches the content of the root.
This method can be overriden to optimize rendering,
or to render in a non standard way.</p>
<p>For example, using <code>innerHTML</code> instead of <code>$el.html</code></p>
<pre><code class="lang-js">attachElContent: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">html</span>) </span>{
  <span class="hljs-keyword">this</span>.el.innerHTML = html;
  <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;
}
</code></pre>

            </div>
            
            <div class="content"><div class='highlight'><pre>    attachElContent: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">html</span>) </span>{
      <span class="hljs-keyword">this</span>.$el.html(html);
  
      <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;
    },</pre></div></div>
            
        </li>
        
        
        <li id="section-302">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-302">&#182;</a>
              </div>
              <p>You might need to override this if you’ve overridden attachHtml</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    attachBuffer: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">compositeView, buffer</span>) </span>{
      <span class="hljs-keyword">var</span> $container = <span class="hljs-keyword">this</span>.getChildViewContainer(compositeView);
      $container.append(buffer);
    },</pre></div></div>
            
        </li>
        
        
        <li id="section-303">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-303">&#182;</a>
              </div>
              <p>Internal method. Append a view to the end of the $el.
Overidden from CollectionView to ensure view is appended to
childViewContainer</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    _insertAfter: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">childView</span>) </span>{
      <span class="hljs-keyword">var</span> $container = <span class="hljs-keyword">this</span>.getChildViewContainer(<span class="hljs-keyword">this</span>);
      $container.append(childView.el);
    },</pre></div></div>
            
        </li>
        
        
        <li id="section-304">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-304">&#182;</a>
              </div>
              <p>Internal method to ensure an <code>$childViewContainer</code> exists, for the
<code>attachHtml</code> method to use.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    getChildViewContainer: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">containerView</span>) </span>{
      <span class="hljs-keyword">if</span> (<span class="hljs-string">'$childViewContainer'</span> <span class="hljs-keyword">in</span> containerView) {
        <span class="hljs-keyword">return</span> containerView.$childViewContainer;
      }
  
      <span class="hljs-keyword">var</span> container;
      <span class="hljs-keyword">var</span> childViewContainer = Marionette.getOption(containerView, <span class="hljs-string">'childViewContainer'</span>);
      <span class="hljs-keyword">if</span> (childViewContainer) {
  
        <span class="hljs-keyword">var</span> selector = _.isFunction(childViewContainer) ? childViewContainer.call(containerView) : childViewContainer;
  
        <span class="hljs-keyword">if</span> (selector.charAt(<span class="hljs-number">0</span>) === <span class="hljs-string">'@'</span> &amp;&amp; containerView.ui) {
          container = containerView.ui[selector.substr(<span class="hljs-number">4</span>)];
        } <span class="hljs-keyword">else</span> {
          container = containerView.$(selector);
        }
  
        <span class="hljs-keyword">if</span> (container.length &lt;= <span class="hljs-number">0</span>) {
          throwError(<span class="hljs-string">'The specified "childViewContainer" was not found: '</span> +
            containerView.childViewContainer, <span class="hljs-string">'ChildViewContainerMissingError'</span>);
        }
  
      } <span class="hljs-keyword">else</span> {
        container = containerView.$el;
      }
  
      containerView.$childViewContainer = container;
      <span class="hljs-keyword">return</span> container;
    },</pre></div></div>
            
        </li>
        
        
        <li id="section-305">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-305">&#182;</a>
              </div>
              <p>Internal method to reset the <code>$childViewContainer</code> on render</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    resetChildViewContainer: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
      <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.$childViewContainer) {
        <span class="hljs-keyword">delete</span> <span class="hljs-keyword">this</span>.$childViewContainer;
      }
    }
  });</pre></div></div>
            
        </li>
        
        
        <li id="section-306">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-306">&#182;</a>
              </div>
              <h2 id="layoutview">LayoutView</h2>

            </div>
            
        </li>
        
        
        <li id="section-307">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-307">&#182;</a>
              </div>
              
            </div>
            
        </li>
        
        
        <li id="section-308">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-308">&#182;</a>
              </div>
              <p>Used for managing application layoutViews, nested layoutViews and
multiple regions within an application or sub-application.</p>
<p>A specialized view class that renders an area of HTML and then
attaches <code>Region</code> instances to the specified <code>regions</code>.
Used for composite view management and sub-application areas.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  Marionette.LayoutView = Marionette.ItemView.extend({
    <span class="hljs-attr">regionClass</span>: Marionette.Region,</pre></div></div>
            
        </li>
        
        
        <li id="section-309">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-309">&#182;</a>
              </div>
              <p>Ensure the regions are available when the <code>initialize</code> method
is called.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    <span class="hljs-keyword">constructor</span>: function(options) {
      options = options || {};
  
      <span class="hljs-keyword">this</span>._firstRender = <span class="hljs-literal">true</span>;
      <span class="hljs-keyword">this</span>._initializeRegions(options);
  
      Marionette.ItemView.call(<span class="hljs-keyword">this</span>, options);
    },</pre></div></div>
            
        </li>
        
        
        <li id="section-310">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-310">&#182;</a>
              </div>
              <p>LayoutView’s render will use the existing region objects the
first time it is called. Subsequent calls will destroy the
views that the regions are showing and then reset the <code>el</code>
for the regions to the newly rendered DOM elements.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    render: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
      <span class="hljs-keyword">this</span>._ensureViewIsIntact();
  
      <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>._firstRender) {</pre></div></div>
            
        </li>
        
        
        <li id="section-311">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-311">&#182;</a>
              </div>
              <p>if this is the first render, don’t do anything to
reset the regions</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        <span class="hljs-keyword">this</span>._firstRender = <span class="hljs-literal">false</span>;
      } <span class="hljs-keyword">else</span> {</pre></div></div>
            
        </li>
        
        
        <li id="section-312">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-312">&#182;</a>
              </div>
              <p>If this is not the first render call, then we need to
re-initialize the <code>el</code> for each region</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        <span class="hljs-keyword">this</span>._reInitializeRegions();
      }
  
      <span class="hljs-keyword">return</span> Marionette.ItemView.prototype.render.apply(<span class="hljs-keyword">this</span>, <span class="hljs-built_in">arguments</span>);
    },</pre></div></div>
            
        </li>
        
        
        <li id="section-313">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-313">&#182;</a>
              </div>
              <p>Handle destroying regions, and then destroy the view itself.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    destroy: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
      <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.isDestroyed) { <span class="hljs-keyword">return</span>; }
  
      <span class="hljs-keyword">this</span>.regionManager.destroy();
      Marionette.ItemView.prototype.destroy.apply(<span class="hljs-keyword">this</span>, <span class="hljs-built_in">arguments</span>);
    },</pre></div></div>
            
        </li>
        
        
        <li id="section-314">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-314">&#182;</a>
              </div>
              <p>Add a single region, by name, to the layoutView</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    addRegion: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">name, definition</span>) </span>{
      <span class="hljs-keyword">this</span>.triggerMethod(<span class="hljs-string">'before:region:add'</span>, name);
      <span class="hljs-keyword">var</span> regions = {};
      regions[name] = definition;
      <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>._buildRegions(regions)[name];
    },</pre></div></div>
            
        </li>
        
        
        <li id="section-315">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-315">&#182;</a>
              </div>
              <p>Add multiple regions as a {name: definition, name2: def2} object literal</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    addRegions: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">regions</span>) </span>{
      <span class="hljs-keyword">this</span>.regions = _.extend({}, <span class="hljs-keyword">this</span>.regions, regions);
      <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>._buildRegions(regions);
    },</pre></div></div>
            
        </li>
        
        
        <li id="section-316">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-316">&#182;</a>
              </div>
              <p>Remove a single region from the LayoutView, by name</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    removeRegion: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">name</span>) </span>{
      <span class="hljs-keyword">this</span>.triggerMethod(<span class="hljs-string">'before:region:remove'</span>, name);
      <span class="hljs-keyword">delete</span> <span class="hljs-keyword">this</span>.regions[name];
      <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.regionManager.removeRegion(name);
    },</pre></div></div>
            
        </li>
        
        
        <li id="section-317">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-317">&#182;</a>
              </div>
              <p>Provides alternative access to regions
Accepts the region name
getRegion(‘main’)</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    getRegion: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">region</span>) </span>{
      <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.regionManager.get(region);
    },</pre></div></div>
            
        </li>
        
        
        <li id="section-318">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-318">&#182;</a>
              </div>
              <p>Get all regions</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    getRegions: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>{
      <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.regionManager.getRegions();
    },</pre></div></div>
            
        </li>
        
        
        <li id="section-319">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-319">&#182;</a>
              </div>
              <p>internal method to build regions</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    _buildRegions: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">regions</span>) </span>{
      <span class="hljs-keyword">var</span> that = <span class="hljs-keyword">this</span>;
  
      <span class="hljs-keyword">var</span> defaults = {
        <span class="hljs-attr">regionClass</span>: <span class="hljs-keyword">this</span>.getOption(<span class="hljs-string">'regionClass'</span>),
        <span class="hljs-attr">parentEl</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{ <span class="hljs-keyword">return</span> that.$el; }
      };
  
      <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.regionManager.addRegions(regions, defaults);
    },</pre></div></div>
            
        </li>
        
        
        <li id="section-320">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-320">&#182;</a>
              </div>
              <p>Internal method to initialize the regions that have been defined in a
<code>regions</code> attribute on this layoutView.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    _initializeRegions: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">options</span>) </span>{
      <span class="hljs-keyword">var</span> regions;
      <span class="hljs-keyword">this</span>._initRegionManager();
  
      <span class="hljs-keyword">if</span> (_.isFunction(<span class="hljs-keyword">this</span>.regions)) {
        regions = <span class="hljs-keyword">this</span>.regions(options);
      } <span class="hljs-keyword">else</span> {
        regions = <span class="hljs-keyword">this</span>.regions || {};
      }</pre></div></div>
            
        </li>
        
        
        <li id="section-321">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-321">&#182;</a>
              </div>
              <p>Enable users to define <code>regions</code> as instance options.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      <span class="hljs-keyword">var</span> regionOptions = <span class="hljs-keyword">this</span>.getOption.call(options, <span class="hljs-string">'regions'</span>);</pre></div></div>
            
        </li>
        
        
        <li id="section-322">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-322">&#182;</a>
              </div>
              <p>enable region options to be a function</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      <span class="hljs-keyword">if</span> (_.isFunction(regionOptions)) {
        regionOptions = regionOptions.call(<span class="hljs-keyword">this</span>, options);
      }
  
      _.extend(regions, regionOptions);
  
      <span class="hljs-keyword">this</span>.addRegions(regions);
    },</pre></div></div>
            
        </li>
        
        
        <li id="section-323">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-323">&#182;</a>
              </div>
              <p>Internal method to re-initialize all of the regions by updating the <code>el</code> that
they point to</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    _reInitializeRegions: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
      <span class="hljs-keyword">this</span>.regionManager.emptyRegions();
      <span class="hljs-keyword">this</span>.regionManager.each(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">region</span>) </span>{
        region.reset();
      });
    },</pre></div></div>
            
        </li>
        
        
        <li id="section-324">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-324">&#182;</a>
              </div>
              <p>Enable easy overiding of the default <code>RegionManager</code>
for customized region interactions and buisness specific
view logic for better control over single regions.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    getRegionManager: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
      <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> Marionette.RegionManager();
    },</pre></div></div>
            
        </li>
        
        
        <li id="section-325">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-325">&#182;</a>
              </div>
              <p>Internal method to initialize the region manager
and all regions in it</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    _initRegionManager: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
      <span class="hljs-keyword">this</span>.regionManager = <span class="hljs-keyword">this</span>.getRegionManager();
  
      <span class="hljs-keyword">this</span>.listenTo(<span class="hljs-keyword">this</span>.regionManager, <span class="hljs-string">'before:add:region'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">name</span>) </span>{
        <span class="hljs-keyword">this</span>.triggerMethod(<span class="hljs-string">'before:add:region'</span>, name);
      });
  
      <span class="hljs-keyword">this</span>.listenTo(<span class="hljs-keyword">this</span>.regionManager, <span class="hljs-string">'add:region'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">name, region</span>) </span>{
        <span class="hljs-keyword">this</span>[name] = region;
        <span class="hljs-keyword">this</span>.triggerMethod(<span class="hljs-string">'add:region'</span>, name, region);
      });
  
      <span class="hljs-keyword">this</span>.listenTo(<span class="hljs-keyword">this</span>.regionManager, <span class="hljs-string">'before:remove:region'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">name</span>) </span>{
        <span class="hljs-keyword">this</span>.triggerMethod(<span class="hljs-string">'before:remove:region'</span>, name);
      });
  
      <span class="hljs-keyword">this</span>.listenTo(<span class="hljs-keyword">this</span>.regionManager, <span class="hljs-string">'remove:region'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">name, region</span>) </span>{
        <span class="hljs-keyword">delete</span> <span class="hljs-keyword">this</span>[name];
        <span class="hljs-keyword">this</span>.triggerMethod(<span class="hljs-string">'remove:region'</span>, name, region);
      });
    }
  });</pre></div></div>
            
        </li>
        
        
        <li id="section-326">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-326">&#182;</a>
              </div>
              <h2 id="behavior">Behavior</h2>

            </div>
            
        </li>
        
        
        <li id="section-327">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-327">&#182;</a>
              </div>
              
            </div>
            
        </li>
        
        
        <li id="section-328">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-328">&#182;</a>
              </div>
              <p>A Behavior is an isolated set of DOM /
user interactions that can be mixed into any View.
Behaviors allow you to blackbox View specific interactions
into portable logical chunks, keeping your views simple and your code DRY.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  
  Marionette.Behavior = (<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">_, Backbone</span>) </span>{
    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Behavior</span>(<span class="hljs-params">options, view</span>) </span>{</pre></div></div>
            
        </li>
        
        
        <li id="section-329">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-329">&#182;</a>
              </div>
              <p>Setup reference to the view.
this comes in handle when a behavior
wants to directly talk up the chain
to the view.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      <span class="hljs-keyword">this</span>.view = view;
      <span class="hljs-keyword">this</span>.defaults = _.result(<span class="hljs-keyword">this</span>, <span class="hljs-string">'defaults'</span>) || {};
      <span class="hljs-keyword">this</span>.options  = _.extend({}, <span class="hljs-keyword">this</span>.defaults, options);</pre></div></div>
            
        </li>
        
        
        <li id="section-330">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-330">&#182;</a>
              </div>
              <p>proxy behavior $ method to the view
this is useful for doing jquery DOM lookups
scoped to behaviors view.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      <span class="hljs-keyword">this</span>.$ = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.view.$.apply(<span class="hljs-keyword">this</span>.view, <span class="hljs-built_in">arguments</span>);
      };</pre></div></div>
            
        </li>
        
        
        <li id="section-331">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-331">&#182;</a>
              </div>
              <p>Call the initialize method passing
the arguments from the instance constructor</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      <span class="hljs-keyword">this</span>.initialize.apply(<span class="hljs-keyword">this</span>, <span class="hljs-built_in">arguments</span>);
    }
  
    _.extend(Behavior.prototype, Backbone.Events, {
      <span class="hljs-attr">initialize</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{},</pre></div></div>
            
        </li>
        
        
        <li id="section-332">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-332">&#182;</a>
              </div>
              <p>stopListening to behavior <code>onListen</code> events.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      destroy: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">this</span>.stopListening();
      },</pre></div></div>
            
        </li>
        
        
        <li id="section-333">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-333">&#182;</a>
              </div>
              <p>import the <code>triggerMethod</code> to trigger events with corresponding
methods if the method exists</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      triggerMethod: Marionette.triggerMethod,</pre></div></div>
            
        </li>
        
        
        <li id="section-334">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-334">&#182;</a>
              </div>
              <p>Proxy <code>getOption</code> to enable getting options from this or this.options by name.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      getOption: Marionette.proxyGetOption,</pre></div></div>
            
        </li>
        
        
        <li id="section-335">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-335">&#182;</a>
              </div>
              <p>Proxy <code>unbindEntityEvents</code> to enable binding view’s events from another entity.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      bindEntityEvents: Marionette.proxyBindEntityEvents,</pre></div></div>
            
        </li>
        
        
        <li id="section-336">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-336">&#182;</a>
              </div>
              <p>Proxy <code>unbindEntityEvents</code> to enable unbinding view’s events from another entity.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      unbindEntityEvents: Marionette.proxyUnbindEntityEvents
    });</pre></div></div>
            
        </li>
        
        
        <li id="section-337">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-337">&#182;</a>
              </div>
              <p>Borrow Backbones extend implementation
this allows us to setup a proper
inheritence pattern that follow in suite
with the rest of Marionette views.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    Behavior.extend = Marionette.extend;
  
    <span class="hljs-keyword">return</span> Behavior;
  })(_, Backbone);
  
  <span class="hljs-comment">/* jshint maxlen: 143, nonew: false */</span></pre></div></div>
            
        </li>
        
        
        <li id="section-338">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-338">&#182;</a>
              </div>
              <h2 id="marionette-behaviors">Marionette.Behaviors</h2>

            </div>
            
        </li>
        
        
        <li id="section-339">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-339">&#182;</a>
              </div>
              
            </div>
            
        </li>
        
        
        <li id="section-340">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-340">&#182;</a>
              </div>
              <p>Behaviors is a utility class that takes care of
glueing your behavior instances to their given View.
The most important part of this class is that you
<strong>MUST</strong> override the class level behaviorsLookup
method for things to work properly.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  
  Marionette.Behaviors = (<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">Marionette, _</span>) </span>{
  
    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Behaviors</span>(<span class="hljs-params">view, behaviors</span>) </span>{</pre></div></div>
            
        </li>
        
        
        <li id="section-341">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-341">&#182;</a>
              </div>
              <p>Behaviors defined on a view can be a flat object literal
or it can be a function that returns an object.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      behaviors = Behaviors.parseBehaviors(view, behaviors || _.result(view, <span class="hljs-string">'behaviors'</span>));</pre></div></div>
            
        </li>
        
        
        <li id="section-342">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-342">&#182;</a>
              </div>
              <p>Wraps several of the view’s methods
calling the methods first on each behavior
and then eventually calling the method on the view.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      Behaviors.wrap(view, behaviors, _.keys(methods));
    }
  
    <span class="hljs-keyword">var</span> methods = {
      <span class="hljs-attr">setElement</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">setElement, behaviors</span>) </span>{
        setElement.apply(<span class="hljs-keyword">this</span>, _.tail(<span class="hljs-built_in">arguments</span>, <span class="hljs-number">2</span>));</pre></div></div>
            
        </li>
        
        
        <li id="section-343">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-343">&#182;</a>
              </div>
              <p>proxy behavior $el to the view’s $el.
This is needed because a view’s $el proxy
is not set until after setElement is called.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        _.each(behaviors, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">b</span>) </span>{
          b.$el = <span class="hljs-keyword">this</span>.$el;
        }, <span class="hljs-keyword">this</span>);
      },
  
      <span class="hljs-attr">destroy</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">destroy, behaviors</span>) </span>{
        <span class="hljs-keyword">var</span> args = _.tail(<span class="hljs-built_in">arguments</span>, <span class="hljs-number">2</span>);
        destroy.apply(<span class="hljs-keyword">this</span>, args);</pre></div></div>
            
        </li>
        
        
        <li id="section-344">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-344">&#182;</a>
              </div>
              <p>Call destroy on each behavior after
destroying the view.
This unbinds event listeners
that behaviors have registerd for.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        _.invoke(behaviors, <span class="hljs-string">'destroy'</span>, args);
      },
  
      <span class="hljs-attr">bindUIElements</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">bindUIElements, behaviors</span>) </span>{
        bindUIElements.apply(<span class="hljs-keyword">this</span>);
        _.invoke(behaviors, bindUIElements);
      },
  
      <span class="hljs-attr">unbindUIElements</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">unbindUIElements, behaviors</span>) </span>{
        unbindUIElements.apply(<span class="hljs-keyword">this</span>);
        _.invoke(behaviors, unbindUIElements);
      },
  
      <span class="hljs-attr">triggerMethod</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">triggerMethod, behaviors</span>) </span>{
        <span class="hljs-keyword">var</span> args = _.tail(<span class="hljs-built_in">arguments</span>, <span class="hljs-number">2</span>);
        triggerMethod.apply(<span class="hljs-keyword">this</span>, args);
  
        _.each(behaviors, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">b</span>) </span>{
          triggerMethod.apply(b, args);
        });
      },
  
      <span class="hljs-attr">delegateEvents</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">delegateEvents, behaviors</span>) </span>{
        <span class="hljs-keyword">var</span> args = _.tail(<span class="hljs-built_in">arguments</span>, <span class="hljs-number">2</span>);
        delegateEvents.apply(<span class="hljs-keyword">this</span>, args);
  
        _.each(behaviors, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">b</span>) </span>{
          Marionette.bindEntityEvents(b, <span class="hljs-keyword">this</span>.model, Marionette.getOption(b, <span class="hljs-string">'modelEvents'</span>));
          Marionette.bindEntityEvents(b, <span class="hljs-keyword">this</span>.collection, Marionette.getOption(b, <span class="hljs-string">'collectionEvents'</span>));
        }, <span class="hljs-keyword">this</span>);
      },
  
      <span class="hljs-attr">undelegateEvents</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">undelegateEvents, behaviors</span>) </span>{
        <span class="hljs-keyword">var</span> args = _.tail(<span class="hljs-built_in">arguments</span>, <span class="hljs-number">2</span>);
        undelegateEvents.apply(<span class="hljs-keyword">this</span>, args);
  
        _.each(behaviors, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">b</span>) </span>{
          Marionette.unbindEntityEvents(b, <span class="hljs-keyword">this</span>.model, Marionette.getOption(b, <span class="hljs-string">'modelEvents'</span>));
          Marionette.unbindEntityEvents(b, <span class="hljs-keyword">this</span>.collection, Marionette.getOption(b, <span class="hljs-string">'collectionEvents'</span>));
        }, <span class="hljs-keyword">this</span>);
      },
  
      <span class="hljs-attr">behaviorEvents</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">behaviorEvents, behaviors</span>) </span>{
        <span class="hljs-keyword">var</span> _behaviorsEvents = {};
        <span class="hljs-keyword">var</span> viewUI = _.result(<span class="hljs-keyword">this</span>, <span class="hljs-string">'ui'</span>);
  
        _.each(behaviors, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">b, i</span>) </span>{
          <span class="hljs-keyword">var</span> _events = {};
          <span class="hljs-keyword">var</span> behaviorEvents = _.clone(_.result(b, <span class="hljs-string">'events'</span>)) || {};
          <span class="hljs-keyword">var</span> behaviorUI = _.result(b, <span class="hljs-string">'ui'</span>);</pre></div></div>
            
        </li>
        
        
        <li id="section-345">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-345">&#182;</a>
              </div>
              <p>Construct an internal UI hash first using
the views UI hash and then the behaviors UI hash.
This allows the user to use UI hash elements
defined in the parent view as well as those
defined in the given behavior.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>          <span class="hljs-keyword">var</span> ui = _.extend({}, viewUI, behaviorUI);</pre></div></div>
            
        </li>
        
        
        <li id="section-346">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-346">&#182;</a>
              </div>
              <p>Normalize behavior events hash to allow
a user to use the @ui. syntax.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>          behaviorEvents = Marionette.normalizeUIKeys(behaviorEvents, ui);
  
          _.each(_.keys(behaviorEvents), <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">key</span>) </span>{</pre></div></div>
            
        </li>
        
        
        <li id="section-347">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-347">&#182;</a>
              </div>
              <p>Append white-space at the end of each key to prevent behavior key collisions.
This is relying on the fact that backbone events considers “click .foo” the same as
“click .foo “.</p>

            </div>
            
        </li>
        
        
        <li id="section-348">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-348">&#182;</a>
              </div>
              <p>+2 is used because new Array(1) or 0 is “” and not “ “</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>            <span class="hljs-keyword">var</span> whitespace = (<span class="hljs-keyword">new</span> <span class="hljs-built_in">Array</span>(i + <span class="hljs-number">2</span>)).join(<span class="hljs-string">' '</span>);
            <span class="hljs-keyword">var</span> eventKey   = key + whitespace;
            <span class="hljs-keyword">var</span> handler    = _.isFunction(behaviorEvents[key]) ? behaviorEvents[key] : b[behaviorEvents[key]];
  
            _events[eventKey] = _.bind(handler, b);
          });
  
          _behaviorsEvents = _.extend(_behaviorsEvents, _events);
        });
  
        <span class="hljs-keyword">return</span> _behaviorsEvents;
      }
    };
  
    _.extend(Behaviors, {</pre></div></div>
            
        </li>
        
        
        <li id="section-349">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-349">&#182;</a>
              </div>
              <p>Placeholder method to be extended by the user.
The method should define the object that stores the behaviors.
i.e.</p>
<pre><code class="lang-js">Marionette.Behaviors.behaviorsLookup: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">return</span> App.Behaviors
}
</code></pre>

            </div>
            
            <div class="content"><div class='highlight'><pre>      behaviorsLookup: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">'You must define where your behaviors are stored.'</span> +
          <span class="hljs-string">'See https://github.com/marionettejs/backbone.marionette'</span> +
          <span class="hljs-string">'/blob/master/docs/marionette.behaviors.md#behaviorslookup'</span>);
      },</pre></div></div>
            
        </li>
        
        
        <li id="section-350">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-350">&#182;</a>
              </div>
              <p>Takes care of getting the behavior class
given options and a key.
If a user passes in options.behaviorClass
default to using that. Otherwise delegate
the lookup to the users <code>behaviorsLookup</code> implementation.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      getBehaviorClass: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">options, key</span>) </span>{
        <span class="hljs-keyword">if</span> (options.behaviorClass) {
          <span class="hljs-keyword">return</span> options.behaviorClass;
        }</pre></div></div>
            
        </li>
        
        
        <li id="section-351">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-351">&#182;</a>
              </div>
              <p>Get behavior class can be either a flat object or a method</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        <span class="hljs-keyword">return</span> _.isFunction(Behaviors.behaviorsLookup) ? Behaviors.behaviorsLookup.apply(<span class="hljs-keyword">this</span>, <span class="hljs-built_in">arguments</span>)[key] : Behaviors.behaviorsLookup[key];
      },</pre></div></div>
            
        </li>
        
        
        <li id="section-352">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-352">&#182;</a>
              </div>
              <p>Iterate over the behaviors object, for each behavior
instantiate it and get its grouped behaviors.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      parseBehaviors: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">view, behaviors</span>) </span>{
        <span class="hljs-keyword">return</span> _.chain(behaviors).map(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">options, key</span>) </span>{
          <span class="hljs-keyword">var</span> BehaviorClass = Behaviors.getBehaviorClass(options, key);
  
          <span class="hljs-keyword">var</span> behavior = <span class="hljs-keyword">new</span> BehaviorClass(options, view);
          <span class="hljs-keyword">var</span> nestedBehaviors = Behaviors.parseBehaviors(view, _.result(behavior, <span class="hljs-string">'behaviors'</span>));
  
          <span class="hljs-keyword">return</span> [behavior].concat(nestedBehaviors);
        }).flatten().value();
      },</pre></div></div>
            
        </li>
        
        
        <li id="section-353">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-353">&#182;</a>
              </div>
              <p>Wrap view internal methods so that they delegate to behaviors. For example,
<code>onDestroy</code> should trigger destroy on all of the behaviors and then destroy itself.
i.e.</p>
<p><code>view.delegateEvents = _.partial(methods.delegateEvents, view.delegateEvents, behaviors);</code></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      wrap: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">view, behaviors, methodNames</span>) </span>{
        _.each(methodNames, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">methodName</span>) </span>{
          view[methodName] = _.partial(methods[methodName], view[methodName], behaviors);
        });
      }
    });
  
    <span class="hljs-keyword">return</span> Behaviors;
  
  })(Marionette, _);</pre></div></div>
            
        </li>
        
        
        <li id="section-354">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-354">&#182;</a>
              </div>
              <h2 id="approuter">AppRouter</h2>

            </div>
            
        </li>
        
        
        <li id="section-355">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-355">&#182;</a>
              </div>
              
            </div>
            
        </li>
        
        
        <li id="section-356">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-356">&#182;</a>
              </div>
              <p>Reduce the boilerplate code of handling route events
and then calling a single method on another object.
Have your routers configured to call the method on
your object, directly.</p>
<p>Configure an AppRouter with <code>appRoutes</code>.</p>
<p>App routers can only take one <code>controller</code> object.
It is recommended that you divide your controller
objects in to smaller pieces of related functionality
and have multiple routers / controllers, instead of
just one giant router and controller.</p>
<p>You can also add standard routes to an AppRouter.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  
  Marionette.AppRouter = Backbone.Router.extend({
  
    <span class="hljs-attr">constructor</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">options</span>) </span>{
      Backbone.Router.apply(<span class="hljs-keyword">this</span>, <span class="hljs-built_in">arguments</span>);
  
      <span class="hljs-keyword">this</span>.options = options || {};
  
      <span class="hljs-keyword">var</span> appRoutes = <span class="hljs-keyword">this</span>.getOption(<span class="hljs-string">'appRoutes'</span>);
      <span class="hljs-keyword">var</span> controller = <span class="hljs-keyword">this</span>._getController();
      <span class="hljs-keyword">this</span>.processAppRoutes(controller, appRoutes);
      <span class="hljs-keyword">this</span>.on(<span class="hljs-string">'route'</span>, <span class="hljs-keyword">this</span>._processOnRoute, <span class="hljs-keyword">this</span>);
    },</pre></div></div>
            
        </li>
        
        
        <li id="section-357">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-357">&#182;</a>
              </div>
              <p>Similar to route method on a Backbone Router but
method is called on the controller</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    appRoute: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">route, methodName</span>) </span>{
      <span class="hljs-keyword">var</span> controller = <span class="hljs-keyword">this</span>._getController();
      <span class="hljs-keyword">this</span>._addAppRoute(controller, route, methodName);
    },</pre></div></div>
            
        </li>
        
        
        <li id="section-358">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-358">&#182;</a>
              </div>
              <p>process the route event and trigger the onRoute
method call, if it exists</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    _processOnRoute: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">routeName, routeArgs</span>) </span>{</pre></div></div>
            
        </li>
        
        
        <li id="section-359">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-359">&#182;</a>
              </div>
              <p>find the path that matched</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      <span class="hljs-keyword">var</span> routePath = _.invert(<span class="hljs-keyword">this</span>.appRoutes)[routeName];</pre></div></div>
            
        </li>
        
        
        <li id="section-360">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-360">&#182;</a>
              </div>
              <p>make sure an onRoute is there, and call it</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      <span class="hljs-keyword">if</span> (_.isFunction(<span class="hljs-keyword">this</span>.onRoute)) {
        <span class="hljs-keyword">this</span>.onRoute(routeName, routePath, routeArgs);
      }
    },</pre></div></div>
            
        </li>
        
        
        <li id="section-361">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-361">&#182;</a>
              </div>
              <p>Internal method to process the <code>appRoutes</code> for the
router, and turn them in to routes that trigger the
specified method on the specified <code>controller</code>.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    processAppRoutes: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">controller, appRoutes</span>) </span>{
      <span class="hljs-keyword">if</span> (!appRoutes) { <span class="hljs-keyword">return</span>; }
  
      <span class="hljs-keyword">var</span> routeNames = _.keys(appRoutes).reverse(); <span class="hljs-comment">// Backbone requires reverted order of routes</span>
  
      _.each(routeNames, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">route</span>) </span>{
        <span class="hljs-keyword">this</span>._addAppRoute(controller, route, appRoutes[route]);
      }, <span class="hljs-keyword">this</span>);
    },
  
    <span class="hljs-attr">_getController</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
      <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.getOption(<span class="hljs-string">'controller'</span>);
    },
  
    <span class="hljs-attr">_addAppRoute</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">controller, route, methodName</span>) </span>{
      <span class="hljs-keyword">var</span> method = controller[methodName];
  
      <span class="hljs-keyword">if</span> (!method) {
        throwError(<span class="hljs-string">'Method "'</span> + methodName + <span class="hljs-string">'" was not found on the controller'</span>);
      }
  
      <span class="hljs-keyword">this</span>.route(route, methodName, _.bind(method, controller));
    },</pre></div></div>
            
        </li>
        
        
        <li id="section-362">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-362">&#182;</a>
              </div>
              <p>Proxy <code>getOption</code> to enable getting options from this or this.options by name.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    getOption: Marionette.proxyGetOption
  });</pre></div></div>
            
        </li>
        
        
        <li id="section-363">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-363">&#182;</a>
              </div>
              <h2 id="application">Application</h2>

            </div>
            
        </li>
        
        
        <li id="section-364">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-364">&#182;</a>
              </div>
              
            </div>
            
        </li>
        
        
        <li id="section-365">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-365">&#182;</a>
              </div>
              <p>Contain and manage the composite application as a whole.
Stores and starts up <code>Region</code> objects, includes an
event aggregator as <code>app.vent</code></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  Marionette.Application = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">options</span>) </span>{
    <span class="hljs-keyword">this</span>._initRegionManager();
    <span class="hljs-keyword">this</span>._initCallbacks = <span class="hljs-keyword">new</span> Marionette.Callbacks();
    <span class="hljs-keyword">var</span> globalCh = Backbone.Wreqr.radio.channel(<span class="hljs-string">'global'</span>);
    <span class="hljs-keyword">this</span>.vent = globalCh.vent;
    <span class="hljs-keyword">this</span>.commands = globalCh.commands;
    <span class="hljs-keyword">this</span>.reqres = globalCh.reqres;
    <span class="hljs-keyword">this</span>.submodules = {};
  
    _.extend(<span class="hljs-keyword">this</span>, options);
  };
  
  _.extend(Marionette.Application.prototype, Backbone.Events, {</pre></div></div>
            
        </li>
        
        
        <li id="section-366">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-366">&#182;</a>
              </div>
              <p>Command execution, facilitated by Backbone.Wreqr.Commands</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    execute: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
      <span class="hljs-keyword">this</span>.commands.execute.apply(<span class="hljs-keyword">this</span>.commands, <span class="hljs-built_in">arguments</span>);
    },</pre></div></div>
            
        </li>
        
        
        <li id="section-367">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-367">&#182;</a>
              </div>
              <p>Request/response, facilitated by Backbone.Wreqr.RequestResponse</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    request: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
      <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.reqres.request.apply(<span class="hljs-keyword">this</span>.reqres, <span class="hljs-built_in">arguments</span>);
    },</pre></div></div>
            
        </li>
        
        
        <li id="section-368">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-368">&#182;</a>
              </div>
              <p>Add an initializer that is either run at when the <code>start</code>
method is called, or run immediately if added after <code>start</code>
has already been called.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    addInitializer: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">initializer</span>) </span>{
      <span class="hljs-keyword">this</span>._initCallbacks.add(initializer);
    },</pre></div></div>
            
        </li>
        
        
        <li id="section-369">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-369">&#182;</a>
              </div>
              <p>kick off all of the application’s processes.
initializes all of the regions that have been added
to the app, and runs all of the initializer functions</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    start: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">options</span>) </span>{
      <span class="hljs-keyword">this</span>.triggerMethod(<span class="hljs-string">'before:start'</span>, options);
      <span class="hljs-keyword">this</span>._initCallbacks.run(options, <span class="hljs-keyword">this</span>);
      <span class="hljs-keyword">this</span>.triggerMethod(<span class="hljs-string">'start'</span>, options);
    },</pre></div></div>
            
        </li>
        
        
        <li id="section-370">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-370">&#182;</a>
              </div>
              <p>Add regions to your app.
Accepts a hash of named strings or Region objects
addRegions({something: “#someRegion”})
addRegions({something: Region.extend({el: “#someRegion”}) });</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    addRegions: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">regions</span>) </span>{
      <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>._regionManager.addRegions(regions);
    },</pre></div></div>
            
        </li>
        
        
        <li id="section-371">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-371">&#182;</a>
              </div>
              <p>Empty all regions in the app, without removing them</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    emptyRegions: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
      <span class="hljs-keyword">this</span>._regionManager.emptyRegions();
    },</pre></div></div>
            
        </li>
        
        
        <li id="section-372">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-372">&#182;</a>
              </div>
              <p>Removes a region from your app, by name
Accepts the regions name
removeRegion(‘myRegion’)</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    removeRegion: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">region</span>) </span>{
      <span class="hljs-keyword">this</span>._regionManager.removeRegion(region);
    },</pre></div></div>
            
        </li>
        
        
        <li id="section-373">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-373">&#182;</a>
              </div>
              <p>Provides alternative access to regions
Accepts the region name
getRegion(‘main’)</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    getRegion: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">region</span>) </span>{
      <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>._regionManager.get(region);
    },</pre></div></div>
            
        </li>
        
        
        <li id="section-374">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-374">&#182;</a>
              </div>
              <p>Get all the regions from the region manager</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    getRegions: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>{
      <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>._regionManager.getRegions();
    },</pre></div></div>
            
        </li>
        
        
        <li id="section-375">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-375">&#182;</a>
              </div>
              <p>Create a module, attached to the application</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    <span class="hljs-built_in">module</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">moduleNames, moduleDefinition</span>) </span>{</pre></div></div>
            
        </li>
        
        
        <li id="section-376">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-376">&#182;</a>
              </div>
              <p>Overwrite the module class if the user specifies one</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      <span class="hljs-keyword">var</span> ModuleClass = Marionette.Module.getClass(moduleDefinition);</pre></div></div>
            
        </li>
        
        
        <li id="section-377">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-377">&#182;</a>
              </div>
              <p>slice the args, and add this application object as the
first argument of the array</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      <span class="hljs-keyword">var</span> args = slice.call(<span class="hljs-built_in">arguments</span>);
      args.unshift(<span class="hljs-keyword">this</span>);</pre></div></div>
            
        </li>
        
        
        <li id="section-378">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-378">&#182;</a>
              </div>
              <p>see the Marionette.Module object for more information</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      <span class="hljs-keyword">return</span> ModuleClass.create.apply(ModuleClass, args);
    },</pre></div></div>
            
        </li>
        
        
        <li id="section-379">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-379">&#182;</a>
              </div>
              <p>Internal method to set up the region manager</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    _initRegionManager: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
      <span class="hljs-keyword">this</span>._regionManager = <span class="hljs-keyword">new</span> Marionette.RegionManager();
  
      <span class="hljs-keyword">this</span>.listenTo(<span class="hljs-keyword">this</span>._regionManager, <span class="hljs-string">'before:add:region'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">name</span>) </span>{
        <span class="hljs-keyword">this</span>.triggerMethod(<span class="hljs-string">'before:add:region'</span>, name);
      });
  
      <span class="hljs-keyword">this</span>.listenTo(<span class="hljs-keyword">this</span>._regionManager, <span class="hljs-string">'add:region'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">name, region</span>) </span>{
        <span class="hljs-keyword">this</span>[name] = region;
        <span class="hljs-keyword">this</span>.triggerMethod(<span class="hljs-string">'add:region'</span>, name, region);
      });
  
      <span class="hljs-keyword">this</span>.listenTo(<span class="hljs-keyword">this</span>._regionManager, <span class="hljs-string">'before:remove:region'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">name</span>) </span>{
        <span class="hljs-keyword">this</span>.triggerMethod(<span class="hljs-string">'before:remove:region'</span>, name);
      });
  
      <span class="hljs-keyword">this</span>.listenTo(<span class="hljs-keyword">this</span>._regionManager, <span class="hljs-string">'remove:region'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">name, region</span>) </span>{
        <span class="hljs-keyword">delete</span> <span class="hljs-keyword">this</span>[name];
        <span class="hljs-keyword">this</span>.triggerMethod(<span class="hljs-string">'remove:region'</span>, name, region);
      });
    },</pre></div></div>
            
        </li>
        
        
        <li id="section-380">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-380">&#182;</a>
              </div>
              <p>import the <code>triggerMethod</code> to trigger events with corresponding
methods if the method exists</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    triggerMethod: Marionette.triggerMethod
  });</pre></div></div>
            
        </li>
        
        
        <li id="section-381">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-381">&#182;</a>
              </div>
              <p>Copy the <code>extend</code> function used by Backbone’s classes</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  Marionette.Application.extend = Marionette.extend;
  
  <span class="hljs-comment">/* jshint maxparams: 9 */</span></pre></div></div>
            
        </li>
        
        
        <li id="section-382">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-382">&#182;</a>
              </div>
              <h2 id="module">Module</h2>

            </div>
            
        </li>
        
        
        <li id="section-383">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-383">&#182;</a>
              </div>
              
            </div>
            
        </li>
        
        
        <li id="section-384">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-384">&#182;</a>
              </div>
              <p>A simple module system, used to create privacy and encapsulation in
Marionette applications</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  Marionette.Module = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">moduleName, app, options</span>) </span>{
    <span class="hljs-keyword">this</span>.moduleName = moduleName;
    <span class="hljs-keyword">this</span>.options = _.extend({}, <span class="hljs-keyword">this</span>.options, options);</pre></div></div>
            
        </li>
        
        
        <li id="section-385">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-385">&#182;</a>
              </div>
              <p>Allow for a user to overide the initialize
for a given module instance.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    <span class="hljs-keyword">this</span>.initialize = options.initialize || <span class="hljs-keyword">this</span>.initialize;</pre></div></div>
            
        </li>
        
        
        <li id="section-386">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-386">&#182;</a>
              </div>
              <p>Set up an internal store for sub-modules.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    <span class="hljs-keyword">this</span>.submodules = {};
  
    <span class="hljs-keyword">this</span>._setupInitializersAndFinalizers();</pre></div></div>
            
        </li>
        
        
        <li id="section-387">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-387">&#182;</a>
              </div>
              <p>Set an internal reference to the app
within a module.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    <span class="hljs-keyword">this</span>.app = app;</pre></div></div>
            
        </li>
        
        
        <li id="section-388">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-388">&#182;</a>
              </div>
              <p>By default modules start with their parents.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    <span class="hljs-keyword">this</span>.startWithParent = <span class="hljs-literal">true</span>;
  
    <span class="hljs-keyword">if</span> (_.isFunction(<span class="hljs-keyword">this</span>.initialize)) {
      <span class="hljs-keyword">this</span>.initialize(moduleName, app, <span class="hljs-keyword">this</span>.options);
    }
  };
  
  Marionette.Module.extend = Marionette.extend;</pre></div></div>
            
        </li>
        
        
        <li id="section-389">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-389">&#182;</a>
              </div>
              <p>Extend the Module prototype with events / listenTo, so that the module
can be used as an event aggregator or pub/sub.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  _.extend(Marionette.Module.prototype, Backbone.Events, {</pre></div></div>
            
        </li>
        
        
        <li id="section-390">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-390">&#182;</a>
              </div>
              <p>Initialize is an empty function by default. Override it with your own
initialization logic when extending Marionette.Module.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    initialize: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{},</pre></div></div>
            
        </li>
        
        
        <li id="section-391">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-391">&#182;</a>
              </div>
              <p>Initializer for a specific module. Initializers are run when the
module’s <code>start</code> method is called.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    addInitializer: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">callback</span>) </span>{
      <span class="hljs-keyword">this</span>._initializerCallbacks.add(callback);
    },</pre></div></div>
            
        </li>
        
        
        <li id="section-392">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-392">&#182;</a>
              </div>
              <p>Finalizers are run when a module is stopped. They are used to teardown
and finalize any variables, references, events and other code that the
module had set up.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    addFinalizer: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">callback</span>) </span>{
      <span class="hljs-keyword">this</span>._finalizerCallbacks.add(callback);
    },</pre></div></div>
            
        </li>
        
        
        <li id="section-393">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-393">&#182;</a>
              </div>
              <p>Start the module, and run all of its initializers</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    start: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">options</span>) </span>{</pre></div></div>
            
        </li>
        
        
        <li id="section-394">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-394">&#182;</a>
              </div>
              <p>Prevent re-starting a module that is already started</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>._isInitialized) { <span class="hljs-keyword">return</span>; }</pre></div></div>
            
        </li>
        
        
        <li id="section-395">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-395">&#182;</a>
              </div>
              <p>start the sub-modules (depth-first hierarchy)</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      _.each(<span class="hljs-keyword">this</span>.submodules, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">mod</span>) </span>{</pre></div></div>
            
        </li>
        
        
        <li id="section-396">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-396">&#182;</a>
              </div>
              <p>check to see if we should start the sub-module with this parent</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        <span class="hljs-keyword">if</span> (mod.startWithParent) {
          mod.start(options);
        }
      });</pre></div></div>
            
        </li>
        
        
        <li id="section-397">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-397">&#182;</a>
              </div>
              <p>run the callbacks to “start” the current module</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      <span class="hljs-keyword">this</span>.triggerMethod(<span class="hljs-string">'before:start'</span>, options);
  
      <span class="hljs-keyword">this</span>._initializerCallbacks.run(options, <span class="hljs-keyword">this</span>);
      <span class="hljs-keyword">this</span>._isInitialized = <span class="hljs-literal">true</span>;
  
      <span class="hljs-keyword">this</span>.triggerMethod(<span class="hljs-string">'start'</span>, options);
    },</pre></div></div>
            
        </li>
        
        
        <li id="section-398">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-398">&#182;</a>
              </div>
              <p>Stop this module by running its finalizers and then stop all of
the sub-modules for this module</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    stop: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{</pre></div></div>
            
        </li>
        
        
        <li id="section-399">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-399">&#182;</a>
              </div>
              <p>if we are not initialized, don’t bother finalizing</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">this</span>._isInitialized) { <span class="hljs-keyword">return</span>; }
      <span class="hljs-keyword">this</span>._isInitialized = <span class="hljs-literal">false</span>;
  
      <span class="hljs-keyword">this</span>.triggerMethod(<span class="hljs-string">'before:stop'</span>);</pre></div></div>
            
        </li>
        
        
        <li id="section-400">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-400">&#182;</a>
              </div>
              <p>stop the sub-modules; depth-first, to make sure the
sub-modules are stopped / finalized before parents</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      _.each(<span class="hljs-keyword">this</span>.submodules, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">mod</span>) </span>{ mod.stop(); });</pre></div></div>
            
        </li>
        
        
        <li id="section-401">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-401">&#182;</a>
              </div>
              <p>run the finalizers</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      <span class="hljs-keyword">this</span>._finalizerCallbacks.run(<span class="hljs-literal">undefined</span>, <span class="hljs-keyword">this</span>);</pre></div></div>
            
        </li>
        
        
        <li id="section-402">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-402">&#182;</a>
              </div>
              <p>reset the initializers and finalizers</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      <span class="hljs-keyword">this</span>._initializerCallbacks.reset();
      <span class="hljs-keyword">this</span>._finalizerCallbacks.reset();
  
      <span class="hljs-keyword">this</span>.triggerMethod(<span class="hljs-string">'stop'</span>);
    },</pre></div></div>
            
        </li>
        
        
        <li id="section-403">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-403">&#182;</a>
              </div>
              <p>Configure the module with a definition function and any custom args
that are to be passed in to the definition function</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    addDefinition: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">moduleDefinition, customArgs</span>) </span>{
      <span class="hljs-keyword">this</span>._runModuleDefinition(moduleDefinition, customArgs);
    },</pre></div></div>
            
        </li>
        
        
        <li id="section-404">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-404">&#182;</a>
              </div>
              <p>Internal method: run the module definition function with the correct
arguments</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    _runModuleDefinition: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">definition, customArgs</span>) </span>{</pre></div></div>
            
        </li>
        
        
        <li id="section-405">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-405">&#182;</a>
              </div>
              <p>If there is no definition short circut the method.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      <span class="hljs-keyword">if</span> (!definition) { <span class="hljs-keyword">return</span>; }</pre></div></div>
            
        </li>
        
        
        <li id="section-406">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-406">&#182;</a>
              </div>
              <p>build the correct list of arguments for the module definition</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      <span class="hljs-keyword">var</span> args = _.flatten([
        <span class="hljs-keyword">this</span>,
        <span class="hljs-keyword">this</span>.app,
        Backbone,
        Marionette,
        Backbone.$, _,
        customArgs
      ]);
  
      definition.apply(<span class="hljs-keyword">this</span>, args);
    },</pre></div></div>
            
        </li>
        
        
        <li id="section-407">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-407">&#182;</a>
              </div>
              <p>Internal method: set up new copies of initializers and finalizers.
Calling this method will wipe out all existing initializers and
finalizers.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    _setupInitializersAndFinalizers: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
      <span class="hljs-keyword">this</span>._initializerCallbacks = <span class="hljs-keyword">new</span> Marionette.Callbacks();
      <span class="hljs-keyword">this</span>._finalizerCallbacks = <span class="hljs-keyword">new</span> Marionette.Callbacks();
    },</pre></div></div>
            
        </li>
        
        
        <li id="section-408">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-408">&#182;</a>
              </div>
              <p>import the <code>triggerMethod</code> to trigger events with corresponding
methods if the method exists</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    triggerMethod: Marionette.triggerMethod
  });</pre></div></div>
            
        </li>
        
        
        <li id="section-409">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-409">&#182;</a>
              </div>
              <p>Class methods to create modules</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  _.extend(Marionette.Module, {</pre></div></div>
            
        </li>
        
        
        <li id="section-410">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-410">&#182;</a>
              </div>
              <p>Create a module, hanging off the app parameter as the parent object.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    create: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">app, moduleNames, moduleDefinition</span>) </span>{
      <span class="hljs-keyword">var</span> <span class="hljs-built_in">module</span> = app;</pre></div></div>
            
        </li>
        
        
        <li id="section-411">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-411">&#182;</a>
              </div>
              <p>get the custom args passed in after the module definition and
get rid of the module name and definition function</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      <span class="hljs-keyword">var</span> customArgs = slice.call(<span class="hljs-built_in">arguments</span>);
      customArgs.splice(<span class="hljs-number">0</span>, <span class="hljs-number">3</span>);</pre></div></div>
            
        </li>
        
        
        <li id="section-412">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-412">&#182;</a>
              </div>
              <p>Split the module names and get the number of submodules.
i.e. an example module name of <code>Doge.Wow.Amaze</code> would
then have the potential for 3 module definitions.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      moduleNames = moduleNames.split(<span class="hljs-string">'.'</span>);
      <span class="hljs-keyword">var</span> length = moduleNames.length;</pre></div></div>
            
        </li>
        
        
        <li id="section-413">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-413">&#182;</a>
              </div>
              <p>store the module definition for the last module in the chain</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      <span class="hljs-keyword">var</span> moduleDefinitions = [];
      moduleDefinitions[length - <span class="hljs-number">1</span>] = moduleDefinition;</pre></div></div>
            
        </li>
        
        
        <li id="section-414">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-414">&#182;</a>
              </div>
              <p>Loop through all the parts of the module definition</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      _.each(moduleNames, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">moduleName, i</span>) </span>{
        <span class="hljs-keyword">var</span> parentModule = <span class="hljs-built_in">module</span>;
        <span class="hljs-built_in">module</span> = <span class="hljs-keyword">this</span>._getModule(parentModule, moduleName, app, moduleDefinition);
        <span class="hljs-keyword">this</span>._addModuleDefinition(parentModule, <span class="hljs-built_in">module</span>, moduleDefinitions[i], customArgs);
      }, <span class="hljs-keyword">this</span>);</pre></div></div>
            
        </li>
        
        
        <li id="section-415">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-415">&#182;</a>
              </div>
              <p>Return the last module in the definition chain</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      <span class="hljs-keyword">return</span> <span class="hljs-built_in">module</span>;
    },
  
    <span class="hljs-attr">_getModule</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">parentModule, moduleName, app, def, args</span>) </span>{
      <span class="hljs-keyword">var</span> options = _.extend({}, def);
      <span class="hljs-keyword">var</span> ModuleClass = <span class="hljs-keyword">this</span>.getClass(def);</pre></div></div>
            
        </li>
        
        
        <li id="section-416">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-416">&#182;</a>
              </div>
              <p>Get an existing module of this name if we have one</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      <span class="hljs-keyword">var</span> <span class="hljs-built_in">module</span> = parentModule[moduleName];
  
      <span class="hljs-keyword">if</span> (!<span class="hljs-built_in">module</span>) {</pre></div></div>
            
        </li>
        
        
        <li id="section-417">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-417">&#182;</a>
              </div>
              <p>Create a new module if we don’t have one</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        <span class="hljs-built_in">module</span> = <span class="hljs-keyword">new</span> ModuleClass(moduleName, app, options);
        parentModule[moduleName] = <span class="hljs-built_in">module</span>;</pre></div></div>
            
        </li>
        
        
        <li id="section-418">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-418">&#182;</a>
              </div>
              <p>store the module on the parent</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        parentModule.submodules[moduleName] = <span class="hljs-built_in">module</span>;
      }
  
      <span class="hljs-keyword">return</span> <span class="hljs-built_in">module</span>;
    },</pre></div></div>
            
        </li>
        
        
        <li id="section-419">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-419">&#182;</a>
              </div>
              <h2 id="module-classes">Module Classes</h2>
<p>Module classes can be used as an alternative to the define pattern.
The extend function of a Module is identical to the extend functions
on other Backbone and Marionette classes.
This allows module lifecyle events like <code>onStart</code> and <code>onStop</code> to be called directly.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    getClass: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">moduleDefinition</span>) </span>{
      <span class="hljs-keyword">var</span> ModuleClass = Marionette.Module;
  
      <span class="hljs-keyword">if</span> (!moduleDefinition) {
        <span class="hljs-keyword">return</span> ModuleClass;
      }</pre></div></div>
            
        </li>
        
        
        <li id="section-420">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-420">&#182;</a>
              </div>
              <p>If all of the module’s functionality is defined inside its class,
then the class can be passed in directly. <code>MyApp.module(&quot;Foo&quot;, FooModule)</code>.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      <span class="hljs-keyword">if</span> (moduleDefinition.prototype <span class="hljs-keyword">instanceof</span> ModuleClass) {
        <span class="hljs-keyword">return</span> moduleDefinition;
      }
  
      <span class="hljs-keyword">return</span> moduleDefinition.moduleClass || ModuleClass;
    },</pre></div></div>
            
        </li>
        
        
        <li id="section-421">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-421">&#182;</a>
              </div>
              <p>Add the module definition and add a startWithParent initializer function.
This is complicated because module definitions are heavily overloaded
and support an anonymous function, module class, or options object</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    _addModuleDefinition: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">parentModule, module, def, args</span>) </span>{
      <span class="hljs-keyword">var</span> fn = <span class="hljs-keyword">this</span>._getDefine(def);
      <span class="hljs-keyword">var</span> startWithParent = <span class="hljs-keyword">this</span>._getStartWithParent(def, <span class="hljs-built_in">module</span>);
  
      <span class="hljs-keyword">if</span> (fn) {
        <span class="hljs-built_in">module</span>.addDefinition(fn, args);
      }
  
      <span class="hljs-keyword">this</span>._addStartWithParent(parentModule, <span class="hljs-built_in">module</span>, startWithParent);
    },
  
    <span class="hljs-attr">_getStartWithParent</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">def, module</span>) </span>{
      <span class="hljs-keyword">var</span> swp;
  
      <span class="hljs-keyword">if</span> (_.isFunction(def) &amp;&amp; (def.prototype <span class="hljs-keyword">instanceof</span> Marionette.Module)) {
        swp = <span class="hljs-built_in">module</span>.constructor.prototype.startWithParent;
        <span class="hljs-keyword">return</span> _.isUndefined(swp) ? <span class="hljs-literal">true</span> : swp;
      }
  
      <span class="hljs-keyword">if</span> (_.isObject(def)) {
        swp = def.startWithParent;
        <span class="hljs-keyword">return</span> _.isUndefined(swp) ? <span class="hljs-literal">true</span> : swp;
      }
  
      <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
    },
  
    <span class="hljs-attr">_getDefine</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">def</span>) </span>{
      <span class="hljs-keyword">if</span> (_.isFunction(def) &amp;&amp; !(def.prototype <span class="hljs-keyword">instanceof</span> Marionette.Module)) {
        <span class="hljs-keyword">return</span> def;
      }
  
      <span class="hljs-keyword">if</span> (_.isObject(def)) {
        <span class="hljs-keyword">return</span> def.define;
      }
  
      <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
    },
  
    <span class="hljs-attr">_addStartWithParent</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">parentModule, module, startWithParent</span>) </span>{
      <span class="hljs-built_in">module</span>.startWithParent = <span class="hljs-built_in">module</span>.startWithParent &amp;&amp; startWithParent;
  
      <span class="hljs-keyword">if</span> (!<span class="hljs-built_in">module</span>.startWithParent || !!<span class="hljs-built_in">module</span>.startWithParentIsConfigured) {
        <span class="hljs-keyword">return</span>;
      }
  
      <span class="hljs-built_in">module</span>.startWithParentIsConfigured = <span class="hljs-literal">true</span>;
  
      parentModule.addInitializer(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">options</span>) </span>{
        <span class="hljs-keyword">if</span> (<span class="hljs-built_in">module</span>.startWithParent) {
          <span class="hljs-built_in">module</span>.start(options);
        }
      });
    }
  });
  

  <span class="hljs-keyword">return</span> Marionette;
}));</pre></div></div>
            
        </li>
        
    </ul>
  </div>
</body>
</html>
